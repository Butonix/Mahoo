(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{371:function(t,e,n){},444:function(t,e,n){"use strict";var r=n(371);n.n(r).a},486:function(t,e,n){"use strict";n.r(e);n(30);var r=n(2),o=n(40),c=n(59),h={name:"UserAuthSetting",data:function(){return{phone:"",password:"",authCode:"",timeout:0,showInfoForm:!1,loadingBindPhone:!1}},computed:{isAuth:function(){return this.$store.state.isAuth},user:function(){return this.$store.state.user}},methods:{bindUserQQ:function(){this.user.providers.bind_qq||(window.location.href="https://api.calibur.tv/callback/oauth2/qq?from=bind&token=".concat(Object(c.a)(),"&redirect=").concat(encodeURIComponent(window.location.href)))},bindUserWechat:function(){this.user.providers.bind_wechat||(window.location.href="https://api.calibur.tv/callback/oauth2/wechat?from=bind&token=".concat(Object(c.a)(),"&redirect=").concat(encodeURIComponent(window.location.href)))},bindUserPhone:function(){var t=this;this.user.providers.bind_phone||(this.timeout?this.showInfoForm=!0:this.$prompt("请输入要绑定的手机号（11位）","绑定手机",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^(0|86|17951)?(1)[0-9]{10}$/,inputErrorMessage:"请输入正确的手机号码"}).then(function(e){var n=e.value;t.phone=n,t.$captcha({success:function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(r){var data,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return data=r.data,e.prev=1,e.next=4,Object(o.i)(t,{type:"bind_phone",phone_number:n,geetest:data});case 4:t.showInfoForm=!0,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t.$toast.error(e.t0.message);case 10:return e.prev=10,t.timeout=60,c=setInterval(function(){--t.timeout||clearInterval(c)},1e3),e.finish(10);case 14:case"end":return e.stop()}},e,null,[[1,7,10,14]])}));return function(t){return e.apply(this,arguments)}}()})}).catch(function(){}))},submitBindPhone:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.user.providers.bind_phone){t.next=2;break}return t.abrupt("return");case 2:if(6===this.authCode.length){t.next=4;break}return t.abrupt("return",this.$toast.warn("请输入正确的短信验证码"));case 4:if(!(this.password.length<6)){t.next=6;break}return t.abrupt("return",this.$toast.warn("密码不能小于6位"));case 6:if(!(this.password.length>16)){t.next=8;break}return t.abrupt("return",this.$toast.warn("密码不能大于16位"));case 8:if(!this.loadingBindPhone){t.next=10;break}return t.abrupt("return");case 10:return this.loadingBindPhone=!0,t.prev=11,t.next=14,Object(o.a)(this,{id:this.user.id,phone:this.phone,password:this.password,authCode:this.authCode});case 14:this.$toast.success("手机号绑定成功").then(function(){e.showInfoForm=!1,window.location.reload()}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11),this.$toast.error(t.t0.message);case 20:return t.prev=20,this.loadingBindPhone=!1,t.finish(20);case 23:case"end":return t.stop()}},t,this,[[11,17,20,23]])}));return function(){return t.apply(this,arguments)}}()}},d=(n(444),n(18)),component=Object(d.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"user-auth-setting"}},[t.isAuth?n("ul",{staticClass:"providers"},[n("li",{on:{click:t.bindUserQQ}},[n("i",{staticClass:"iconfont ic-qq",class:{"is-bind":t.user.providers.bind_qq}})]),t._v(" "),n("li",{on:{click:t.bindUserWechat}},[n("i",{staticClass:"iconfont ic-v-chat",class:{"is-bind":t.user.providers.bind_wechat}})]),t._v(" "),n("li",{on:{click:t.bindUserPhone}},[n("i",{staticClass:"iconfont ic-phone",class:{"is-bind":t.user.providers.bind_phone}})])]):t._e(),t._v(" "),n("v-dialog",{attrs:{width:"400px",title:"填写信息"},on:{submit:t.submitBindPhone},model:{value:t.showInfoForm,callback:function(e){t.showInfoForm=e},expression:"showInfoForm"}},[n("el-input",{attrs:{type:"number",placeholder:"短信验证码","auto-complete":"off"},model:{value:t.authCode,callback:function(e){t.authCode="string"==typeof e?e.trim():e},expression:"authCode"}}),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("el-input",{attrs:{type:"text",placeholder:"密码（6-16个字符组成，区分大小写）","auto-complete":"off"},model:{value:t.password,callback:function(e){t.password="string"==typeof e?e.trim():e},expression:"password"}})],1)],1)},[],!1,null,null,null);e.default=component.exports}}]);