(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{331:function(t,e,n){"use strict";var c=n(2),o=n(47);e.a={beforeMount(){var t=this;return Object(c.a)((function*(){if(t.$store.state.logging)var e=t.$watch("$store.state.logging",()=>{t.$store.state.isAuth?(t.$channel.$fire("user-signed"),e()):(t.$cookie.remove("JWT-TOKEN"),t.$channel.$fire("user-not-sign"))});else{var n=Object(o.a)();t.$store.commit("SET_USER_TOKEN",n),(yield t.$store.dispatch("initAuth"))?(t.$channel.$fire("user-signed"),t.$store.dispatch("getUserRoles")):(t.$cookie.remove("JWT-TOKEN"),t.$channel.$fire("user-not-sign"))}}))()}}},436:function(t,e,n){"use strict";e.a={beforeMount(){this.$channel.$when("user-signed",()=>{var t=()=>Date.now()-this.$cache.get("socket-connect-heartbeat",0)<=1e3;setTimeout(()=>{var e=()=>{this.$channel.socketConnect();var t=setInterval(()=>{this.$store.state.socket.isConnected?this.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(t)},1e3);window.addEventListener("beforeunload",()=>{this.$channel.socketDisconnect()})};t()||"visible"!==document.visibilityState?(this.$store.commit("SOCKET_AUTO_CONNECT"),(()=>{var n=setInterval(()=>{t()?Date.now()-this.$cache.get("socket-on-message-time",0)<=1e3&&this.$store.commit("SOCKET_ONMESSAGE",this.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(e(),clearInterval(n))},2e3)})()):e()},2e3)})},beforeDestroy(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},437:function(t,e,n){},564:function(t,e,n){"use strict";var c=n(437);n.n(c).a},598:function(t,e,n){"use strict";n.r(e);n(41);var c=n(331),o=n(436),r={name:"AppLayout",mixins:[c.a,o.a],data:()=>({activeIndex:0}),beforeMount(){this.$channel.$when("user-not-sign",()=>{this.$router.replace("/app/sign?redirect=".concat(encodeURIComponent("/app/found")))})},methods:{handleClick(t){this.$channel.$emit("main-tab-click",t),t===this.activeIndex&&this.$channel.$emit("main-tab-refresh",t),this.activeIndex=t}}},l=(n(564),n(9)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app-layout"}},[n("keep-alive",[n("nuxt",{staticClass:"main-view"})],1),t._v(" "),n("div",{attrs:{id:"main-tab"}},[n("div",{staticClass:"tab-core"},[n("NLink",{staticClass:"link-0",attrs:{to:"/app/found",replace:""},nativeOn:{click:function(e){return t.handleClick(0)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("发现")])]),t._v(" "),n("NLink",{staticClass:"link-1",attrs:{to:"/app/category",replace:""},nativeOn:{click:function(e){return t.handleClick(1)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("圈子")])]),t._v(" "),n("NLink",{staticClass:"link-write",attrs:{to:"/app/write"}},[n("i",{staticClass:"iconfont ic-addition_fill"})]),t._v(" "),n("NLink",{staticClass:"link-2",attrs:{to:"/app/notice",replace:""},nativeOn:{click:function(e){return t.handleClick(2)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("消息")])]),t._v(" "),n("NLink",{staticClass:"link-3",attrs:{to:"/app/home",replace:""},nativeOn:{click:function(e){return t.handleClick(3)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("我的")])])],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);