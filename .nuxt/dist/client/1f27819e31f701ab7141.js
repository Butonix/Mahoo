(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{330:function(e,t,n){"use strict";var o=n(2),c=n(45);t.a={beforeMount(){var e=this;return Object(o.a)(function*(){if(e.$store.state.logging)var t=e.$watch("$store.state.logging",()=>{e.$store.state.isAuth?(e.$channel.$fire("user-signed"),t()):(e.$cookie.remove("JWT-TOKEN"),e.$channel.$fire("user-not-sign"))});else{var n=Object(c.a)();e.$store.commit("SET_USER_TOKEN",n),(yield e.$store.dispatch("initAuth"))?(e.$channel.$fire("user-signed"),e.$store.dispatch("getUserRoles")):(e.$cookie.remove("JWT-TOKEN"),e.$channel.$fire("user-not-sign"))}})()}}},436:function(e,t,n){"use strict";t.a={beforeMount(){this.$channel.$when("user-signed",()=>{var e=()=>Date.now()-this.$cache.get("socket-connect-heartbeat",0)<=1e3;setTimeout(()=>{var t=()=>{this.$channel.socketConnect();var e=setInterval(()=>{this.$store.state.socket.isConnected?this.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(e)},1e3);window.addEventListener("beforeunload",()=>{this.$channel.socketDisconnect()})};e()||"visible"!==document.visibilityState?(this.$store.commit("SOCKET_AUTO_CONNECT"),(()=>{var n=setInterval(()=>{e()?Date.now()-this.$cache.get("socket-on-message-time",0)<=1e3&&this.$store.commit("SOCKET_ONMESSAGE",this.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(t(),clearInterval(n))},2e3)})()):t()},2e3)})},beforeDestroy(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},437:function(e,t,n){},565:function(e,t,n){"use strict";var o=n(437);n.n(o).a},598:function(e,t,n){"use strict";n.r(t);var o=n(330),c=n(436),r={name:"AppLayout",mixins:[o.a,c.a],beforeMount(){this.$channel.$when("user-not-sign",()=>{window.location=this.$alias.sign()})}},l=(n(565),n(9)),component=Object(l.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app-layout"}},[n("nuxt"),e._v(" "),n("div",{attrs:{id:"main-tab"}},[n("div",{staticClass:"tab-core"},[n("NLink",{attrs:{to:"/app/found",replace:""}},[n("i"),e._v(" "),n("span",[e._v("发现")])]),e._v(" "),n("NLink",{attrs:{to:"/app/category",replace:""}},[n("i"),e._v(" "),n("span",[e._v("分类")])]),e._v(" "),n("NLink",{attrs:{to:"/app/write"}},[n("span",[e._v("+")])]),e._v(" "),n("NLink",{attrs:{to:"/app/notice",replace:""}},[n("i"),e._v(" "),n("span",[e._v("消息")])]),e._v(" "),n("NLink",{attrs:{to:"/app/home",replace:""}},[n("i"),e._v(" "),n("span",[e._v("我的")])])],1)])],1)},[],!1,null,null,null);t.default=component.exports}}]);