(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{345:function(t,e,n){"use strict";n(17);var c,o=n(2),r=n(72);e.a={beforeMount:(c=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$store.state.logging){t.next=4;break}e=this.$watch("$store.state.logging",(function(){c.$store.state.isAuth?(c.$channel.$fire("user-signed"),e()):(c.$cookie.remove("JWT-TOKEN"),c.$channel.$fire("user-not-sign"))})),t.next=10;break;case 4:return n=Object(r.a)(),this.$store.commit("SET_USER_TOKEN",n),t.next=8,this.$store.dispatch("initAuth");case 8:t.sent?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"));case 10:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})}},517:function(t,e,n){"use strict";e.a={beforeMount:function(){var t=this;this.$channel.$when("user-signed",(function(){var e=function(){return Date.now()-t.$cache.get("socket-connect-heartbeat",0)<=1e3};setTimeout((function(){var n,c=function(){t.$channel.socketConnect();var e=setInterval((function(){t.$store.state.socket.isConnected?t.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(e)}),1e3);window.addEventListener("beforeunload",(function(){t.$channel.socketDisconnect()}))};e()||"visible"!==document.visibilityState?(t.$store.commit("SOCKET_AUTO_CONNECT"),n=setInterval((function(){e()?Date.now()-t.$cache.get("socket-on-message-time",0)<=1e3&&t.$store.commit("SOCKET_ONMESSAGE",t.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(c(),clearInterval(n))}),2e3)):c()}),2e3)}))},beforeDestroy:function(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},518:function(t,e,n){},649:function(t,e,n){"use strict";var c=n(518);n.n(c).a},672:function(t,e,n){"use strict";n.r(e);n(62);var c=n(345),o=n(517),r={name:"AppLayout",mixins:[c.a,o.a],data:function(){return{activeIndex:0}},beforeMount:function(){var t=this;this.$channel.$when("user-not-sign",(function(){t.$router.replace("/app/sign?redirect=".concat(encodeURIComponent("/app/found")))}))},methods:{handleClick:function(t){this.$channel.$emit("main-tab-click",t),t===this.activeIndex&&this.$channel.$emit("main-tab-refresh",t),this.activeIndex=t}}},l=(n(649),n(16)),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app-layout"}},[n("keep-alive",[n("nuxt",{staticClass:"main-view"})],1),t._v(" "),n("div",{attrs:{id:"main-tab"}},[n("div",{staticClass:"tab-core"},[n("NLink",{staticClass:"link-0",attrs:{to:"/app/found",replace:""},nativeOn:{click:function(e){return t.handleClick(0)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("发现")])]),t._v(" "),n("NLink",{staticClass:"link-1",attrs:{to:"/app/category",replace:""},nativeOn:{click:function(e){return t.handleClick(1)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("圈子")])]),t._v(" "),n("NLink",{staticClass:"link-write",attrs:{to:"/app/write"}},[n("i",{staticClass:"iconfont ic-addition_fill"})]),t._v(" "),n("NLink",{staticClass:"link-2",attrs:{to:"/app/notice",replace:""},nativeOn:{click:function(e){return t.handleClick(2)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("消息")])]),t._v(" "),n("NLink",{staticClass:"link-3",attrs:{to:"/app/home",replace:""},nativeOn:{click:function(e){return t.handleClick(3)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("我的")])])],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);