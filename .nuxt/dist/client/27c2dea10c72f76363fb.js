(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{239:function(e,t,l){},269:function(e,t,l){},270:function(e,t,l){},272:function(e,t,l){},274:function(e,t,l){},281:function(e,t,l){},283:function(e,t,l){},285:function(e,t,l){},287:function(e,t,l){},321:function(e,t,l){},323:function(e,t,l){},324:function(e,t,l){},327:function(e,t,l){"use strict";var n=l(239);l.n(n).a},340:function(e,t,l){"use strict";l.r(t);l(269),l(19);var n=l(249),r=l.n(n),o=(l(270),l(271)),c=l.n(o),d=(l(272),l(273)),m=l.n(d),f=(l(274),l(275)),v=l.n(f),h=(l(281),l(282)),_=l.n(h),I=(l(283),l(284)),w=l.n(I),k=(l(285),l(286)),x=l.n(k),y=(l(287),l(288)),U=l.n(y),L=(l(321),l(322)),T=l.n(L),$=(l(323),l(124)),j=l.n($),z=(l(324),l(325)),C=l.n(z),S=(l(125),l(126),l(16),l(83),l(36),l(27),l(57),l(6)),P={data:function(){return{uploadHeaders:{key:"",token:""},uploadConfig:{max:5},uploadImageLimit:20,imageUploadAccept:["image/jpeg","image/png","image/jpg"].join(", "),imageUploadAction:"https://upload.qiniup.com",imagePrefix:"http://pr04zzjnf.bkt.clouddn.com",getUpTokenTimer:0,uploadPending:0,uploadImageTotal:0,uploadImageList:[]}},computed:{currentUser:function(){return this.$store.state.user}},mounted:function(){var e=this;this.getUpToken(),this.getUpTokenTimer=setInterval(function(){e.getUpToken()},18e5)},beforeDestroy:function(){this.getUpTokenTimer&&clearInterval(this.getUpTokenTimer)},methods:{getUpToken:function(){var e=Object(S.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get("v1/image/uptoken");case 3:this.uploadHeaders.token=e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}(),handleImageUploadError:function(e,t){var l=this;this.uploadImageList.forEach(function(n,r){n.uid===t.uid&&(l.uploadPending--,l.uploadImageList.splice(r,1),console.log(e))}),this.$toast.error("图片：".concat(t.name," 上传失败"))},handleImageUploadRemove:function(e){var t=this;this.uploadImageList.forEach(function(l,n){l.uid===e.uid&&(t.uploadImageList.splice(n,1),t.uploadImageTotal--)})},handleImageUploadSuccess:function(e,t){var l=this;this.uploadImageList.forEach(function(n,r){n.uid===t.uid&&(l.uploadImageList[r]=Object.assign(n,{data:e.data,status:"success",url:"".concat(l.imagePrefix,"/").concat(e.data.url)}))}),this.uploadImageTotal++,this.uploadPending--},handleImageUploadExceed:function(){this.$toast.warn("最多还能上传".concat(this.uploadImageLimit-this.uploadImageTotal,"张图片"))},handleImageUploadBefore:function(e){if(!this.currentUser)return this.$channel.$emit("sign-in"),!1;if(-1===this.imageUploadAccept.split(", ").indexOf(e.type))return this.$toast.error("仅支持上传".concat(this.imageUploadAccept.replace(/image\//g,"").replace(/, /g,"、"),"格式的图片")),!1;if(this.uploadConfig.max&&this.uploadConfig.max<e.size/1024/1024)return this.$toast.error("图片大小不能超过 ".concat(this.uploadConfig.max,"MB!")),!1;return this.uploadHeaders.key=function(e){var t=e.slug,l=e.file;return"".concat(t,"/").concat((new Date).getTime(),"-").concat(Math.random().toString(36).substring(3,6),".").concat(l.type.split("/").pop())}({slug:this.currentUser.slug,file:e}),this.uploadImageList.push({name:e.name,percentage:0,raw:e,size:e.size,status:"uploading",errMsg:"",uid:e.uid}),this.uploadPending++,!0}}},E={name:"",layout:"web",components:{"el-upload":C.a,"el-input":j.a,"el-form":T.a,"el-form-item":U.a,"el-radio":x.a,"el-radio-group":w.a,"el-cascader":_.a,"el-select":v.a,"el-option":m.a,"el-divider":c.a,"el-tag":r.a},mixins:[P],props:{},data:function(){return{contentType:2,users:{coser:[],dresser:[],worker:[],ender:[],weapon:[]},formItem:{title:"",is_secret:0,textarea:"",area:[],tags:[]},cityList:[{value:"New York",label:"New York"},{value:"London",label:"London"},{value:"Sydney",label:"Sydney"},{value:"Ottawa",label:"Ottawa"},{value:"Paris",label:"Paris"},{value:"Canberra",label:"Canberra"}],areaList:[{value:"beijing",label:"北京",children:[{value:"gugong",label:"故宫"},{value:"tiantan",label:"天坛"},{value:"wangfujing",label:"王府井"}]},{value:"jiangsu",label:"江苏",children:[{value:"nanjing",label:"南京",children:[{value:"fuzimiao",label:"夫子庙"}]},{value:"suzhou",label:"苏州",children:[{value:"zhuozhengyuan",label:"拙政园"},{value:"shizilin",label:"狮子林"}]}]}]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{handleSubmit:function(){},customImageUploadSuccess:function(e,t){this.handleImageUploadSuccess(e,t),this.uploadImageList=this.uploadImageList.filter(function(e){return"success"===e.status&&e.data.width>=420&&e.data.height>=420||"success"!==e.status}),this.uploadImageTotal=this.uploadImageList.length}}},A=(l(327),l(20)),component=Object(A.a)(E,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{attrs:{id:"create-show"}},[l("el-row",{staticClass:"container"},[l("el-col",{attrs:{span:4}},[e._v("\n       \n    ")]),e._v(" "),l("el-col",{attrs:{span:15}},[l("div",{staticClass:"panel main-panel"},[l("el-form",{ref:"form",attrs:{model:e.formItem,"label-position":"right","label-width":"80px"}},[l("p",{staticClass:"form-tip"},[e._v("\n            提示：标记 "),l("span",[e._v("*")]),e._v(" 为必填项，否则无法发布哦\n          ")]),e._v(" "),l("el-form-item",{attrs:{label:"上传图片",required:2===e.contentType}}),e._v(" "),l("div",{staticClass:"uploader",class:"uploader-count-"+(e.uploadImageTotal+e.uploadPending)},[l("el-upload",{attrs:{multiple:"",drag:"","list-type":"picture-card",action:e.imageUploadAction,limit:e.uploadImageLimit,data:e.uploadHeaders,"file-list":e.uploadImageList,accept:e.imageUploadAccept,"before-upload":e.handleImageUploadBefore,"on-success":e.customImageUploadSuccess,"on-error":e.handleImageUploadError,"on-remove":e.handleImageUploadRemove,"on-exceed":e.handleImageUploadExceed}}),e._v(" "),l("p",{staticClass:"uploader-info"},[e._v("\n              最多可上传20张哦 (支持格式 jpg、png，宽高尺寸须大于420像素)\n            ")])],1),e._v(" "),l("el-form-item",{attrs:{label:"分区",required:""}},[l("el-col",{attrs:{span:16}},[l("el-cascader",{attrs:{placeholder:"添加作品分区，如约会大作战",options:e.areaList,filterable:""},model:{value:e.formItem.area,callback:function(t){e.$set(e.formItem,"area",t)},expression:"formItem.area"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"标题",required:""}},[l("el-col",{attrs:{span:16}},[l("el-input",{attrs:{placeholder:"请输入标题","show-word-limit":!0,maxlength:"20"},model:{value:e.formItem.title,callback:function(t){e.$set(e.formItem,"title",t)},expression:"formItem.title"}})],1)],1),e._v(" "),1===e.contentType?[e._v("\n            rich editor\n          ")]:[l("el-form-item",{attrs:{label:"简介"}},[l("el-input",{attrs:{type:"textarea","show-word-limit":!0,rows:8,maxlength:"233",resize:"none",placeholder:"请输入作品介绍，临摹作品请一定要注明作品的出处来源"},model:{value:e.formItem.textarea,callback:function(t){e.$set(e.formItem,"textarea",t)},expression:"formItem.textarea"}})],1)],e._v(" "),l("el-form-item",{attrs:{label:"标签"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"添加标签，方便分享",filterable:"",multiple:"","allow-create":""},model:{value:e.formItem.tags,callback:function(t){e.$set(e.formItem,"tags",t)},expression:"formItem.tags"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])}),1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"访问权限"}},[l("el-radio-group",{model:{value:e.formItem.is_secret,callback:function(t){e.$set(e.formItem,"is_secret",t)},expression:"formItem.is_secret"}},[l("el-radio",{attrs:{label:0}},[e._v("\n                公开\n              ")]),e._v(" "),l("el-radio",{attrs:{label:1}},[e._v("\n                私密\n              ")])],1)],1),e._v(" "),2===e.contentType?[l("br"),e._v(" "),l("el-divider",[e._v("创作者信息")]),e._v(" "),l("br"),e._v(" "),l("br"),e._v(" "),l("el-form-item",{attrs:{label:"出镜"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"coser的昵称",filterable:"",multiple:"","allow-create":""},model:{value:e.users.coser,callback:function(t){e.$set(e.users,"coser",t)},expression:"users.coser"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}),1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"化妆"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"化妆师的昵称",filterable:"",multiple:"","allow-create":""},model:{value:e.users.dresser,callback:function(t){e.$set(e.users,"dresser",t)},expression:"users.dresser"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}),1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"道具"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"道具师的昵称",filterable:"",multiple:"","allow-create":""},model:{value:e.users.weapon,callback:function(t){e.$set(e.users,"weapon",t)},expression:"users.weapon"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}),1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"摄影"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"摄影师的昵称",filterable:"",multiple:"","allow-create":""},model:{value:e.users.worker,callback:function(t){e.$set(e.users,"worker",t)},expression:"users.worker"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}),1)],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"后期"}},[l("el-col",{attrs:{span:16}},[l("el-select",{attrs:{placeholder:"后期君的昵称",filterable:"",multiple:"","allow-create":""},model:{value:e.users.ender,callback:function(t){e.$set(e.users,"ender",t)},expression:"users.ender"}},e._l(e.cityList,function(t){return l("el-option",{key:t.value,attrs:{value:t.value}},[e._v("\n                    "+e._s(t.label)+"\n                  ")])}),1)],1)],1)]:e._e()],2),e._v(" "),l("el-row",[l("el-col",{attrs:{span:10,push:7}},[l("br"),e._v(" "),l("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",shape:"circle",size:"large"},on:{click:e.handleSubmit}},[e._v("\n              提交发布\n            ")])],1)],1)],1)]),e._v(" "),l("el-col",{attrs:{span:5}},[e._v("\n       \n    ")])],1)],1)},[],!1,null,null,null);t.default=component.exports}}]);