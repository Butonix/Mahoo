(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{364:function(t,e,n){"use strict";n(16);var o,c=n(2),r=n(70);e.a={beforeMount:(o=Object(c.a)(regeneratorRuntime.mark(function t(){var e,n,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$store.state.logging){t.next=4;break}e=this.$watch("$store.state.logging",function(){o.$store.state.isAuth?(o.$channel.$fire("user-signed"),e()):(o.$cookie.remove("JWT-TOKEN"),o.$channel.$fire("user-not-sign"))}),t.next=10;break;case 4:return n=Object(r.a)(),this.$store.commit("SET_USER_TOKEN",n),t.next=8,this.$store.dispatch("initAuth");case 8:t.sent?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"));case 10:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})}},484:function(t,e,n){"use strict";e.a={beforeMount:function(){var t=this;this.$channel.$when("user-signed",function(){var e=function(){return Date.now()-t.$cache.get("socket-connect-heartbeat",0)<=1e3};setTimeout(function(){var n,o=function(){t.$channel.socketConnect();var e=setInterval(function(){t.$store.state.socket.isConnected?t.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(e)},1e3);window.addEventListener("beforeunload",function(){t.$channel.socketDisconnect()})};e()||"visible"!==document.visibilityState?(t.$store.commit("SOCKET_AUTO_CONNECT"),n=setInterval(function(){e()?Date.now()-t.$cache.get("socket-on-message-time",0)<=1e3&&t.$store.commit("SOCKET_ONMESSAGE",t.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(o(),clearInterval(n))},2e3)):o()},2e3)})},beforeDestroy:function(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},485:function(t,e,n){},627:function(t,e,n){"use strict";var o=n(485);n.n(o).a},663:function(t,e,n){"use strict";n.r(e);n(62);var o=n(364),c=n(484),r={name:"AppLayout",mixins:[o.a,c.a],beforeMount:function(){var t=this;this.$channel.$when("user-not-sign",function(){t.$router.replace("/app/sign?redirect=".concat(encodeURIComponent("/app/found")))})}},h=(n(627),n(15)),component=Object(h.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app-layout"}},[n("nuxt",{staticClass:"main-view"}),t._v(" "),n("div",{attrs:{id:"main-tab"}},[n("div",{staticClass:"tab-core"},[n("NLink",{attrs:{to:"/app/found",replace:""}},[n("i"),t._v(" "),n("span",[t._v("发现")])]),t._v(" "),n("NLink",{attrs:{to:"/app/category",replace:""}},[n("i"),t._v(" "),n("span",[t._v("分类")])]),t._v(" "),n("NLink",{attrs:{to:"/app/write"}},[n("span",[t._v("+")])]),t._v(" "),n("NLink",{attrs:{to:"/app/notice",replace:""}},[n("i"),t._v(" "),n("span",[t._v("消息")])]),t._v(" "),n("NLink",{attrs:{to:"/app/home",replace:""}},[n("i"),t._v(" "),n("span",[t._v("我的")])])],1)])],1)},[],!1,null,null,null);e.default=component.exports}}]);