(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{305:function(t,e,n){"use strict";var o=n(2),c=n(46);e.a={beforeMount(){var t=this;return Object(o.a)(function*(){if(t.$store.state.logging)var e=t.$watch("$store.state.logging",()=>{t.$store.state.isAuth?(t.$channel.$fire("user-signed"),e()):(t.$cookie.remove("JWT-TOKEN"),t.$channel.$fire("user-not-sign"))});else{var n=Object(c.a)();t.$store.commit("SET_USER_TOKEN",n),(yield t.$store.dispatch("initAuth"))?(t.$channel.$fire("user-signed"),t.$store.dispatch("getUserRoles")):(t.$cookie.remove("JWT-TOKEN"),t.$channel.$fire("user-not-sign"))}})()}}},464:function(t,e,n){"use strict";e.a={beforeMount(){this.$channel.$when("user-signed",()=>{var t=()=>Date.now()-this.$cache.get("socket-connect-heartbeat",0)<=1e3;setTimeout(()=>{var e=()=>{this.$channel.socketConnect();var t=setInterval(()=>{this.$store.state.socket.isConnected?this.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(t)},1e3);window.addEventListener("beforeunload",()=>{this.$channel.socketDisconnect()})};t()||"visible"!==document.visibilityState?(this.$store.commit("SOCKET_AUTO_CONNECT"),(()=>{var n=setInterval(()=>{t()?Date.now()-this.$cache.get("socket-on-message-time",0)<=1e3&&this.$store.commit("SOCKET_ONMESSAGE",this.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(e(),clearInterval(n))},2e3)})()):e()},2e3)})},beforeDestroy(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},465:function(t,e,n){},592:function(t,e,n){"use strict";var o=n(465);n.n(o).a},638:function(t,e,n){"use strict";n.r(e);n(40);var o=n(305),c=n(464),r={name:"AppLayout",mixins:[o.a,c.a],beforeMount(){this.$channel.$when("user-not-sign",()=>{this.$router.replace("/app/sign?redirect=".concat(encodeURIComponent("/app/found")))})}},l=(n(592),n(9)),component=Object(l.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app-layout"}},[n("keep-alive",[n("nuxt",{staticClass:"main-view"})],1),t._v(" "),n("div",{attrs:{id:"main-tab"}},[n("div",{staticClass:"tab-core"},[n("NLink",{staticClass:"link-0",attrs:{to:"/app/found",replace:""}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("发现")])]),t._v(" "),n("NLink",{staticClass:"link-1",attrs:{to:"/app/category",replace:""}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("分区")])]),t._v(" "),n("NLink",{staticClass:"link-write",attrs:{to:"/app/write"}},[n("i",{staticClass:"iconfont ic-addition_fill"})]),t._v(" "),n("NLink",{staticClass:"link-2",attrs:{to:"/app/notice",replace:""}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("消息")])]),t._v(" "),n("NLink",{staticClass:"link-3",attrs:{to:"/app/home",replace:""}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("我的")])])],1)])],1)},[],!1,null,null,null);e.default=component.exports}}]);