(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{227:function(t,e,n){"use strict";n.d(e,"d",function(){return r}),n.d(e,"a",function(){return l}),n.d(e,"e",function(){return o}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return d});n(28);var r=function(t,e){var n=e.slug;return t.$axios.get("v1/tag/show",{params:{slug:n}})},l=function(t,e){var n=e.name,r=e.parent_slug;return t.$axios.post("v1/tag/create",{name:n,parent_slug:r})},o=function(t,e){var n=e.name,r=e.slug,l=e.avatar,o=e.alias,c=e.intro;return t.$axios.post("v1/tag/update",{name:n,slug:r,avatar:l,alias:o,intro:c})},c=function(t,e){var n=e.slug,r=e.target_slug;return t.$axios.post("v1/tag/relink",{slug:n,target_slug:r})},d=function(t,e){var n=e.slug;return t.$axios.post("v1/tag/delete",{slug:n})}},250:function(t,e,n){},343:function(t,e,n){"use strict";var r=n(250);n.n(r).a},354:function(t,e,n){"use strict";n.r(e);var r=n(13),l=(n(28),n(268),n(20),n(269)),o=n.n(l),c=(n(259),n(260)),d=n.n(c),m=(n(281),n(282)),f=n.n(m),v=(n(283),n(127)),h=n.n(v),w=(n(284),n(285)),_=n.n(w),x=n(286),$=n(227),k={name:"",layout:"web",components:{"el-upload":_.a,"el-input":h.a,"el-form":f.a,"el-select":d.a,"el-form-item":o.a},mixins:[x.a],props:{slug:{type:String,required:!0}},data:function(){var t=this;return{tag:null,parent:null,children:[],rules:{alias:[{validator:function(e,n,r){n&&n.length||r(new Error("别名不能为空")),~n.indexOf(t.tag.name)||r(new Error("别名中必须包含名称")),n.some(function(t){return/,/.test(t)})&&r(new Error("别名不能包含英文逗号")),n.join("").length>100&&r(new Error("别名最多100个字符")),r()},trigger:"submit"}]},submitting:!1}},asyncData:function(t){var e=t.app,n=t.error,l=t.params;return Object($.d)(e,{slug:l.slug}).then(function(data){return Object(r.a)({},data)}).catch(n)},methods:{avatarUploadSuccess:function(t){this.tag.avatar=t.data.url},submit:function(){var t=this;this.$refs.form.validate(function(e){e&&(t.submitting=!0,Object($.e)(t,{slug:t.tag.slug,name:t.tag.name,avatar:t.tag.avatar,alias:t.tag.alias.join(","),intro:t.tag.intro}).then(function(){t.$toast.success("修改成功").then(function(){window.location.reload()})}).catch(function(e){t.$toast.error(e.message),t.submitting=!1}))})}}},j=(n(343),n(21)),component=Object(j.a)(k,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"tag-edit"}},[n("el-row",[n("el-col",{attrs:{span:12,offset:6}},[n("el-form",{ref:"form",attrs:{model:t.tag,rules:t.rules,disabled:t.submitting,"label-position":"top"}},[n("el-form-item",{attrs:{label:"头像"}},[n("div",{staticClass:"avatar-field"},[n("img",{staticClass:"avatar",attrs:{src:t.$resize(t.tag.avatar,{width:200,height:200})}}),t._v(" "),n("el-upload",{attrs:{"show-file-list":!1,action:t.imageUploadAction,limit:t.uploadImageLimit,data:t.uploadHeaders,accept:t.imageUploadAccept,"before-upload":t.handleImageUploadBefore,"on-success":t.avatarUploadSuccess,"on-error":t.handleImageUploadError}},[n("el-button",{attrs:{type:"success",plain:"",round:"",size:"mini"}},[t._v("\n                上传标签封面\n              ")])],1)],1)]),t._v(" "),n("el-form-item",{attrs:{label:"名称"}},[n("el-input",{attrs:{disabled:""},model:{value:t.tag.name,callback:function(e){t.$set(t.tag,"name",e)},expression:"tag.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"别名",prop:"alias"}},[n("p",{staticClass:"form-tip"},[t._v("\n            提示：按回车键生效\n          ")]),t._v(" "),n("el-select",{staticClass:"hidden-select-input",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入标签别名","popper-class":"hidden-select-options"},model:{value:t.tag.alias,callback:function(e){t.$set(t.tag,"alias",e)},expression:"tag.alias"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"简介"}},[n("el-input",{attrs:{type:"textarea","show-word-limit":!0,rows:8,maxlength:"233",resize:"none",placeholder:"请输入板块介绍"},model:{value:t.tag.intro,callback:function(e){t.$set(t.tag,"intro",e)},expression:"tag.intro"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{loading:t.submitting,type:"success",round:""},on:{click:t.submit}},[t._v("\n            保存更改\n          ")])],1)],1)],1)],1)],1)},[],!1,null,null,null);e.default=component.exports}}]);