(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{232:function(t,n,e){"use strict";e.d(n,"d",function(){return r}),e.d(n,"a",function(){return o}),e.d(n,"e",function(){return c}),e.d(n,"c",function(){return l}),e.d(n,"b",function(){return v});e(24);var r=function(t,n){var e=n.slug;return t.$axios.get("v1/tag/show",{params:{slug:e}})},o=function(t,n){var e=n.name,r=n.parent_slug;return t.$axios.post("v1/tag/create",{name:e,parent_slug:r})},c=function(t,n){var e=n.name,r=n.slug,o=n.avatar,c=n.alias,l=n.intro;return t.$axios.post("v1/tag/update",{name:e,slug:r,avatar:o,alias:c,intro:l})},l=function(t,n){var e=n.slug,r=n.target_slug;return t.$axios.post("v1/tag/relink",{slug:e,target_slug:r})},v=function(t,n){var e=n.slug;return t.$axios.post("v1/tag/delete",{slug:e})}},359:function(t,n,e){"use strict";e.r(n);var r=e(14),o=(e(24),e(232)),c={name:"TagTree",components:{},head:function(){var t=this.tag;return{title:"".concat(t.name," - 咔哩吧"),meta:[{hid:"keywords",name:"keywords",content:"".concat(t.alias,",").concat("C站,calibur,咔哩吧,ACG,二次元,社区")}]}},props:{slug:{type:String,required:!0}},data:function(){return{tag:null,parent:null,children:[]}},computed:{},watch:{},asyncData:function(t){var n=t.app,e=t.error,c=t.params;return o.d(n,{slug:c.slug}).then(function(data){return Object(r.a)({},data)}).catch(e)},layout:"web",created:function(){},mounted:function(){},methods:{createTag:function(){var t=this;this.$prompt("请输入标签名","创建标签",{confirmButtonText:"提交",cancelButtonText:"取消"}).then(function(n){var e=n.value.trim();if(e.length>32)return t.$toast.error("名字不能超过32个字");o.a(t,{name:e,parent_slug:t.slug}).then(function(data){t.children.push(data),t.$toast.success("标签创建成功")}).catch(function(n){t.$toast.error(n.message)})}).catch(function(){})},combineTag:function(){console.log("combineTag")},deleteTag:function(){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","删除标签",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){o.b(t,{slug:t.slug}).then(function(){t.$toast.success("标签删除成功").then(function(){window.location.reload()})}).catch(function(n){t.$toast.error(n.message)})}).catch(function(){})},relinkTag:function(){var t=this;this.$prompt("请输入目标父节点id","移动标签",{confirmButtonText:"提交",cancelButtonText:"取消",inputPattern:/^[a-z0-9]+$/i,inputErrorMessage:"格式不正确"}).then(function(n){var e=n.value;o.c(t,{slug:t.slug,target_slug:e}).then(function(){t.$toast.success("标签移动成功")}).catch(function(n){t.$toast.error(n.message)})}).catch(function(){})},updateTag:function(){var t=this;this.$prompt("请输入标签名","更新标签",{confirmButtonText:"提交",cancelButtonText:"取消"}).then(function(n){var e=n.value.trim();if(e.length>32)return t.$toast.error("名字不能超过32个字");o.e(t,{name:e,slug:t.slug,avatar:""}).then(function(){t.$toast.success("标签更新成功")}).catch(function(n){t.$toast.error(n.message)})}).catch(function(){})}}},l=e(12),component=Object(l.a)(c,function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"tag-show"}},[e("el-row",{staticClass:"container"},[e("el-col",{attrs:{span:4}},[e("div",{staticClass:"panel"},[t.parent?[e("p",[t._v("父标签")]),t._v(" "),e("nuxt-link",{attrs:{to:"/tag/"+t.parent.slug}},[t._v("\n            "+t._s(t.parent.name)+"\n          ")])]:t._e(),t._v(" "),t.children.length?[e("p",[t._v("子标签")]),t._v(" "),t._l(t.children,function(n){return e("nuxt-link",{key:n.slug,attrs:{to:"/tag/"+n.slug}},[t._v("\n            "+t._s(n.name)+"\n          ")])})]:t._e()],2)]),t._v(" "),e("el-col",{attrs:{span:15}},[e("p",[t._v("当前标签")]),t._v("\n      "+t._s(t.tag.name)+"\n    ")]),t._v(" "),e("el-col",{attrs:{span:5}},[e("div",{staticClass:"panel"},[t._v("\n        当前标签活跃用户\n      ")]),t._v(" "),e("div",{staticClass:"panel"},[e("button",{on:{click:t.createTag}},[t._v("\n          添加子标签\n        ")]),t._v(" "),e("button",{on:{click:t.combineTag}},[t._v("\n          合并标签\n        ")]),t._v(" "),e("button",{on:{click:t.deleteTag}},[t._v("\n          删除标签\n        ")]),t._v(" "),e("button",{on:{click:t.relinkTag}},[t._v("\n          修改父节点\n        ")]),t._v(" "),e("nuxt-link",{attrs:{to:t.$alias.tag(t.slug,"edit")}},[e("button",[t._v("\n            更新标签\n          ")])])],1)])],1)],1)},[],!1,null,null,null);n.default=component.exports}}]);