/*! For license information please see LICENSES */
exports.ids=[34],exports.modules={106:function(t,e){},141:function(t,e){},142:function(t,e,n){"use strict";n.r(e);var r=n(106),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},143:function(t,e){},144:function(t,e){},145:function(t,e){},220:function(t,e,n){"use strict";var r=n(60),o={name:"AreaPicker",components:{ElCascader:n.n(r).a},props:{value:{type:String,required:!0},placeholder:{type:String,default:"选择作品分区，如约会大作战"}},data(){return{selected:this.value}},computed:{options(){return this.$store.state.global.myTags.filter(t=>!~["notebook","topic"].indexOf(t.slug))},myTagsFetched(){return this.$store.state.global.myTagsFetched}},watch:{value(t){this.selected=t},selected(t){this.$emit("input",t)}},mounted(){this.$store.state.isAuth?this.$store.dispatch("global/getMyTags"):this.$channel.$when("user-signed",()=>{this.$store.dispatch("global/getMyTags")})}},l=n(2);var component=Object(l.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"area-picker"},[t._ssrNode('<p class="tip">\n    提示：只展示已解禁的分区（可选项，发表后不可修改）\n  </p> '),t.myTagsFetched?n("ElCascader",{attrs:{placeholder:t.placeholder,options:t.options,props:{value:"slug",label:"name",emitPath:!1},filterable:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.node,data=e.data;return[r.isLeaf?[n("span",[t._v(t._s(data.name))])]:[n("span",[t._v(t._s(data.name))]),t._v(" "),n("span",[t._v(" ("+t._s(data.children.length)+") ")])]]}}],null,!1,2144075774),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}):t._e()],2)},[],!1,function(t){var e=n(142);e.__inject__&&e.__inject__(t)},null,"52f9e5e6");e.a=component.exports},226:function(t,e){},227:function(t,e){},228:function(t,e){},229:function(t,e){},230:function(t,e){},231:function(t,e){},232:function(t,e,n){"use strict";"undefined"!=typeof window&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){let t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(s))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}))},233:function(t,e){},234:function(t,e){},235:function(t,e,n){"use strict";n.r(e);var r=n(141),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},236:function(t,e,n){"use strict";n.r(e);var r=n(143),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},237:function(t,e,n){"use strict";n.r(e);var r=n(144),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},238:function(t,e,n){"use strict";n.r(e);var r=n(145),o=n.n(r);for(var l in r)"default"!==l&&function(t){n.d(e,t,function(){return r[t]})}(l);e.default=o.a},296:function(t,e,n){"use strict";n.r(e);var r=n(56),o=n.n(r),l=n(86),c=n(93),d=n(94);n(226);class h{constructor({data:data,config:t,api:e}){this.api=e,this._CSS={block:this.api.styles.block,settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive,wrapper:"ce-header"},this._settings=t,this._data=this.normalizeData(data),this.settingsButtons=[],this._element=this.getTag()}normalizeData(data){const t={};return"object"!=typeof data&&(data={}),t.text=data.text||"",t.level=parseInt(data.level)||this.defaultLevel.number,t}render(){return this._element}renderSettings(){const t=document.createElement("DIV");return this.levels.forEach(e=>{const n=document.createElement("SPAN");n.classList.add(this._CSS.settingsButton),this.currentLevel.number===e.number&&n.classList.add(this._CSS.settingsButtonActive),n.innerHTML=e.svg,n.dataset.level=e.number,n.addEventListener("click",()=>{this.setLevel(e.number)}),t.appendChild(n),this.settingsButtons.push(n)}),t}setLevel(t){this.data={level:t,text:this.data.text},this.settingsButtons.forEach(button=>{button.classList.toggle(this._CSS.settingsButtonActive,parseInt(button.dataset.level)===t)})}merge(data){const t={text:this.data.text+data.text,level:this.data.level};this.data=t}validate(t){return""!==t.text.trim()}save(t){return{text:t.innerHTML,level:this.currentLevel.number}}static get conversionConfig(){return{export:"text",import:"text"}}static get sanitize(){return{level:{}}}get data(){return this._data.text=this._element.innerHTML,this._data.level=this.currentLevel.number,this._data}set data(data){if(this._data=this.normalizeData(data),void 0!==data.level&&this._element.parentNode){const t=this.getTag();t.innerHTML=this._element.innerHTML,this._element.parentNode.replaceChild(t,this._element),this._element=t}void 0!==data.text&&(this._element.innerHTML=this._data.text||"")}getTag(){const t=document.createElement(this.currentLevel.tag);return t.innerHTML=this._data.text||"",t.classList.add(this._CSS.wrapper),t.contentEditable="true",t.dataset.placeholder=this._settings.placeholder||"",t}get currentLevel(){let t=this.levels.find(t=>t.number===this._data.level);return t||(t=this.defaultLevel),t}get defaultLevel(){return this.levels[1]}get levels(){return[{number:1,tag:"H1",svg:'<svg width="16" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.14 1.494V4.98h4.62V1.494c0-.498.098-.871.293-1.12A.927.927 0 0 1 7.82 0c.322 0 .583.123.782.37.2.246.3.62.3 1.124v9.588c0 .503-.101.88-.303 1.128a.957.957 0 0 1-.779.374.921.921 0 0 1-.77-.378c-.193-.251-.29-.626-.29-1.124V6.989H2.14v4.093c0 .503-.1.88-.302 1.128a.957.957 0 0 1-.778.374.921.921 0 0 1-.772-.378C.096 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.285.374A.922.922 0 0 1 1.06 0c.321 0 .582.123.782.37.199.246.299.62.299 1.124zm11.653 9.985V5.27c-1.279.887-2.14 1.33-2.583 1.33a.802.802 0 0 1-.563-.228.703.703 0 0 1-.245-.529c0-.232.08-.402.241-.511.161-.11.446-.25.854-.424.61-.259 1.096-.532 1.462-.818a5.84 5.84 0 0 0 .97-.962c.282-.355.466-.573.552-.655.085-.082.246-.123.483-.123.267 0 .481.093.642.28.161.186.242.443.242.77v7.813c0 .914-.345 1.371-1.035 1.371-.307 0-.554-.093-.74-.28-.187-.186-.28-.461-.28-.825z"/></svg>'},{number:2,tag:"H2",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm10.99 9.288h3.527c.351 0 .62.072.804.216.185.144.277.34.277.588 0 .22-.073.408-.22.56-.146.154-.368.23-.665.23h-4.972c-.338 0-.601-.093-.79-.28a.896.896 0 0 1-.284-.659c0-.162.06-.377.182-.645s.255-.478.399-.631a38.617 38.617 0 0 1 1.621-1.598c.482-.444.827-.735 1.034-.875.369-.261.676-.523.922-.787.245-.263.432-.534.56-.81.129-.278.193-.549.193-.815 0-.288-.069-.546-.206-.773a1.428 1.428 0 0 0-.56-.53 1.618 1.618 0 0 0-.774-.19c-.59 0-1.054.26-1.392.777-.045.068-.12.252-.226.554-.106.302-.225.534-.358.696-.133.162-.328.243-.585.243a.76.76 0 0 1-.56-.223c-.149-.148-.223-.351-.223-.608 0-.31.07-.635.21-.972.139-.338.347-.645.624-.92a3.093 3.093 0 0 1 1.054-.665c.426-.169.924-.253 1.496-.253.69 0 1.277.108 1.764.324.315.144.592.343.83.595.24.252.425.544.558.875.133.33.2.674.2 1.03 0 .558-.14 1.066-.416 1.523-.277.457-.56.815-.848 1.074-.288.26-.771.666-1.45 1.22-.677.554-1.142.984-1.394 1.29a3.836 3.836 0 0 0-.331.44z"/></svg>'},{number:3,tag:"H3",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm11.61 4.919c.418 0 .778-.123 1.08-.368.301-.245.452-.597.452-1.055 0-.35-.12-.65-.36-.902-.241-.252-.566-.378-.974-.378-.277 0-.505.038-.684.116a1.1 1.1 0 0 0-.426.306 2.31 2.31 0 0 0-.296.49c-.093.2-.178.388-.255.565a.479.479 0 0 1-.245.225.965.965 0 0 1-.409.081.706.706 0 0 1-.5-.22c-.152-.148-.228-.345-.228-.59 0-.236.071-.484.214-.745a2.72 2.72 0 0 1 .627-.746 3.149 3.149 0 0 1 1.024-.568 4.122 4.122 0 0 1 1.368-.214c.44 0 .842.06 1.205.18.364.12.679.294.947.52.267.228.47.49.606.79.136.3.204.622.204.967 0 .454-.099.843-.296 1.168-.198.324-.48.64-.848.95.354.19.653.408.895.653.243.245.426.516.548.813.123.298.184.619.184.964 0 .413-.083.812-.248 1.198-.166.386-.41.73-.732 1.031a3.49 3.49 0 0 1-1.147.708c-.443.17-.932.256-1.467.256a3.512 3.512 0 0 1-1.464-.293 3.332 3.332 0 0 1-1.699-1.64c-.142-.314-.214-.573-.214-.777 0-.263.085-.475.255-.636a.89.89 0 0 1 .637-.242c.127 0 .25.037.367.112a.53.53 0 0 1 .232.27c.236.63.489 1.099.759 1.405.27.306.65.46 1.14.46a1.714 1.714 0 0 0 1.46-.824c.17-.273.256-.588.256-.947 0-.53-.145-.947-.436-1.249-.29-.302-.694-.453-1.212-.453-.09 0-.231.01-.422.028-.19.018-.313.027-.367.027-.25 0-.443-.062-.579-.187-.136-.125-.204-.299-.204-.521 0-.218.081-.394.245-.528.163-.134.406-.2.728-.2h.28z"/></svg>'},{number:4,tag:"H4",svg:'<svg width="20" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm13.003 10.09v-1.252h-3.38c-.427 0-.746-.097-.96-.29-.213-.193-.32-.456-.32-.788 0-.085.016-.171.048-.259.031-.088.078-.18.141-.276.063-.097.128-.19.195-.28.068-.09.15-.2.25-.33l3.568-4.774a5.44 5.44 0 0 1 .576-.683.763.763 0 0 1 .542-.212c.682 0 1.023.39 1.023 1.171v5.212h.29c.346 0 .623.047.832.142.208.094.313.3.313.62 0 .26-.086.45-.256.568-.17.12-.427.179-.768.179h-.41v1.252c0 .346-.077.603-.23.771-.152.168-.356.253-.612.253a.78.78 0 0 1-.61-.26c-.154-.173-.232-.427-.232-.764zm-2.895-2.76h2.895V4.91L12.26 8.823z"/></svg>'},{number:5,tag:"H5",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm14.16 2.645h-3.234l-.388 2.205c.644-.344 1.239-.517 1.783-.517.436 0 .843.082 1.222.245.38.164.712.39.998.677.286.289.51.63.674 1.025.163.395.245.82.245 1.273 0 .658-.148 1.257-.443 1.797-.295.54-.72.97-1.276 1.287-.556.318-1.197.477-1.923.477-.813 0-1.472-.15-1.978-.45-.506-.3-.865-.643-1.076-1.031-.21-.388-.316-.727-.316-1.018 0-.177.073-.345.22-.504a.725.725 0 0 1 .556-.238c.381 0 .665.22.85.66.182.404.427.719.736.943.309.225.654.337 1.035.337.35 0 .656-.09.919-.272.263-.182.466-.431.61-.749.142-.318.214-.678.214-1.082 0-.436-.078-.808-.232-1.117a1.607 1.607 0 0 0-.62-.69 1.674 1.674 0 0 0-.864-.229c-.39 0-.67.048-.837.143-.168.095-.41.262-.725.5-.316.239-.576.358-.78.358a.843.843 0 0 1-.592-.242c-.173-.16-.259-.344-.259-.548 0-.022.025-.177.075-.463l.572-3.26c.063-.39.181-.675.354-.852.172-.177.454-.265.844-.265h3.595c.708 0 1.062.27 1.062.81a.711.711 0 0 1-.26.572c-.172.145-.426.218-.762.218z"/></svg>'},{number:6,tag:"H6",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zM12.53 7.058a3.093 3.093 0 0 1 1.004-.814 2.734 2.734 0 0 1 1.214-.264c.43 0 .827.08 1.19.24.365.161.684.39.957.686.274.296.485.645.635 1.048a3.6 3.6 0 0 1 .223 1.262c0 .637-.145 1.216-.437 1.736-.292.52-.699.926-1.221 1.218-.522.292-1.114.438-1.774.438-.76 0-1.416-.186-1.967-.557-.552-.37-.974-.919-1.265-1.645-.292-.726-.438-1.613-.438-2.662 0-.855.088-1.62.265-2.293.176-.674.43-1.233.76-1.676.33-.443.73-.778 1.2-1.004.47-.226 1.006-.339 1.608-.339.579 0 1.089.113 1.53.34.44.225.773.506.997.84.224.335.335.656.335.964 0 .185-.07.354-.21.505a.698.698 0 0 1-.536.227.874.874 0 0 1-.529-.18 1.039 1.039 0 0 1-.36-.498 1.42 1.42 0 0 0-.495-.655 1.3 1.3 0 0 0-.786-.247c-.24 0-.479.069-.716.207a1.863 1.863 0 0 0-.6.56c-.33.479-.525 1.333-.584 2.563zm1.832 4.213c.456 0 .834-.186 1.133-.56.298-.373.447-.862.447-1.468 0-.412-.07-.766-.21-1.062a1.584 1.584 0 0 0-.577-.678 1.47 1.47 0 0 0-.807-.234c-.28 0-.548.074-.804.224-.255.149-.461.365-.617.647a2.024 2.024 0 0 0-.234.994c0 .61.158 1.12.475 1.527.316.407.714.61 1.194.61z"/></svg>'}]}onPaste(t){const content=t.detail.data;let e=2;switch(content.tagName){case"H1":e=1;break;case"H3":e=3;break;case"H4":e=4;break;case"H5":e=5;break;case"H6":e=6}this.data={level:e,text:content.innerHTML}}static get pasteConfig(){return{tags:["H1","H2","H3","H4","H5","H6"]}}static get toolbox(){return{icon:'<svg width="11" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.6 8.15H2.25v4.525a1.125 1.125 0 0 1-2.25 0V1.125a1.125 1.125 0 1 1 2.25 0V5.9H7.6V1.125a1.125 1.125 0 0 1 2.25 0v11.55a1.125 1.125 0 0 1-2.25 0V8.15z"/></svg>',title:"标题"}}}n(227);class m{constructor({data:data}){this.data=data}static get toolbox(){return{title:"百度云",icon:'<svg width="20px" height="16px" viewBox="0 0 256 206" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">\n  <g>\n    <path d="M170.2517,56.8186 L192.5047,34.5656 L193.9877,25.1956 C153.4367,-11.6774 88.9757,-7.4964 52.4207,33.9196 C42.2667,45.4226 34.7337,59.7636 30.7167,74.5726 L38.6867,73.4496 L83.1917,66.1106 L86.6277,62.5966 C106.4247,40.8546 139.8977,37.9296 162.7557,56.4286 L170.2517,56.8186 Z"></path>\n    <path d="M224.2048,73.9182 C219.0898,55.0822 208.5888,38.1492 193.9878,25.1962 L162.7558,56.4282 C175.9438,67.2042 183.4568,83.4382 183.1348,100.4652 L183.1348,106.0092 C198.4858,106.0092 210.9318,118.4542 210.9318,133.8052 C210.9318,149.1572 198.4858,161.2902 183.1348,161.2902 L127.4638,161.2902 L121.9978,167.2242 L121.9978,200.5642 L127.4638,205.7952 L183.1348,205.7952 C223.0648,206.1062 255.6868,174.3012 255.9978,134.3712 C256.1858,110.1682 244.2528,87.4782 224.2048,73.9182"></path>\n    <path d="M71.8704,205.7957 L127.4634,205.7957 L127.4634,161.2897 L71.8704,161.2897 C67.9094,161.2887 64.0734,160.4377 60.4714,158.7917 L52.5844,161.2117 L30.1754,183.4647 L28.2234,191.0387 C40.7904,200.5277 56.1234,205.8637 71.8704,205.7957"></path>\n    <path d="M71.8704,61.4255 C31.9394,61.6635 -0.2366,94.2275 0.0014,134.1575 C0.1344,156.4555 10.5484,177.4455 28.2234,191.0385 L60.4714,158.7915 C46.4804,152.4705 40.2634,136.0055 46.5844,122.0155 C52.9044,108.0255 69.3704,101.8085 83.3594,108.1285 C89.5244,110.9135 94.4614,115.8515 97.2464,122.0155 L129.4944,89.7685 C115.7734,71.8315 94.4534,61.3445 71.8704,61.4255"></path>\n  </g>\n</svg>'}}render(){const t=document.createElement("div");t.classList.add("baidu-resource");const e=document.createElement("i");e.classList.add("iconfont","ic-baidu-cloud","baidu-resource-icon"),t.appendChild(e);const n=document.createElement("div");n.classList.add("baidu-resource-wrap"),t.appendChild(n);const r=document.createElement("input");r.classList.add("baidu-resource-url"),r.placeholder="粘贴资源链接到这里（仅支持百度云盘：pan.baidu.com）",r.type="text",r.value=this.data&&this.data.url?this.data.url:"",n.appendChild(r);const o=document.createElement("input");o.classList.add("baidu-resource-password"),o.placeholder="填写资源的密码（4~6位）",o.type="text",o.value=this.data&&this.data.password?this.data.password:"",n.appendChild(o);const l=document.createElement("div");l.classList.add("baidu-resource-role-wrap");const c=`${Math.random().toString(36).substring(3,6)}`,d=this.data&&this.data.visit_type?this.data.visit_type:0,h=document.createElement("span");h.textContent="是否需要投食才能看到密码：",l.appendChild(h);const m=document.createElement("input");m.classList.add("baidu-resource-role-public"),m.id=`baidu-resource-role-public-${c}`,m.name=c,m.type="radio",m.value=0,m.checked=0===d,l.appendChild(m);const v=document.createElement("label");v.setAttribute("for",`baidu-resource-role-public-${c}`),v.textContent="否",v.classList.add("baidu-resource-label"),l.appendChild(v);const _=document.createElement("input");_.classList.add("baidu-resource-role-private"),_.id=`baidu-resource-role-private-${c}`,_.type="radio",_.name=c,_.value=1,_.checked=1===d,l.appendChild(_);const f=document.createElement("label");return f.setAttribute("for",`baidu-resource-role-private-${c}`),f.textContent="是",f.classList.add("baidu-resource-label"),l.appendChild(f),n.appendChild(l),t}save(t){const e=t.querySelector(".baidu-resource-url"),n=t.querySelector(".baidu-resource-password"),r=t.querySelector(".baidu-resource-role-public");let o=e.value.trim();return/^https?:\/\//.test(o)||(o="https://"+o),{url:o,password:n.value.trim(),visit_type:r.checked?0:1}}validate(t){return!(!t.url||!t.password)&&!(!/https?:\/\/pan\.baidu\.com\/s\/([\w\W]+)/.test(t.url)||!/^[\w|\W]{4,6}$/.test(t.password))}}n(228);var v=n(7),_={bilibili:{regex:/https?:\/\/www\.bilibili\.com\/video\/av([\w\W]+)/,embedUrl:"//player.bilibili.com/player.html?aid=<%= remote_id %>",html:"<iframe width='100%' height='400' scrolling='no' border='0' frameborder='no' framespacing='0' allowtransparency='true' allowfullscreen='true'></iframe>",id:t=>t[0].split("/")[0].split("?")[0]},bilih5:{regex:/https?:\/\/m\.bilibili\.com\/video\/av([\w\W]+)/,embedUrl:"//player.bilibili.com/player.html?aid=<%= remote_id %>",html:"<iframe width='100%' height='400' scrolling='no' border='0' frameborder='no' framespacing='0' allowtransparency='true' allowfullscreen='true'></iframe>",id:t=>t[0].split(".")[0].split("?")[0]},netease:{regex:/https?:\/\/music\.163\.com\/#\/song\?id=([\w\W]+)/,embedUrl:"//music.163.com/outchain/player?type=2&height=66&id=<%= remote_id %>",html:"<iframe frameborder='no' border='0' marginwidth='0' marginheight='0' width='330' height='86'></iframe>",id:t=>t[0].split("/")[0].split("?")[0]},neteaseh5:{regex:/https?:\/\/music\.163\.com\/m\/song\?id=([\w\W]+)/,embedUrl:"//music.163.com/outchain/player?type=2&height=66&id=<%= remote_id %>",html:"<iframe frameborder='no' border='0' marginwidth='0' marginheight='0' width='330' height='86'></iframe>",id:t=>t[0].split("/")[0].split("?")[0]}};class f{constructor({data:data,api:t}){this.api=t,this._data={},this.element=null,this.data=data}set data(data){if(!(data instanceof Object))throw new TypeError("Embed Tool data should be object");const{service:t,source:source,embed:embed,width:e,height:n,caption:caption=""}=data;this._data={service:t||this.data.service,source:source||this.data.source,embed:embed||this.data.embed,width:e||this.data.width,height:n||this.data.height,caption:caption||this.data.caption||""};const r=this.element;r&&r.parentNode.replaceChild(this.render(),r)}get data(){if(this.element){const caption=this.element.querySelector(`.${this.api.styles.input}`);this._data.caption=caption?caption.innerHTML:""}return this._data}get CSS(){return{baseClass:this.api.styles.block,input:this.api.styles.input,container:"embed-tool",containerLoading:"embed-tool--loading",preloader:"embed-tool__preloader",caption:"embed-tool__caption",url:"embed-tool__url",content:"embed-tool__content"}}render(){if(!this.data.service){const t=document.createElement("div");return this.element=t,t}const{html:html}=f.services[this.data.service],t=document.createElement("div"),caption=document.createElement("div"),template=document.createElement("template"),e=this.createPreloader();t.classList.add(this.CSS.baseClass,this.CSS.container,this.CSS.containerLoading),caption.classList.add(this.CSS.input,this.CSS.caption),t.appendChild(e),caption.contentEditable=!0,caption.dataset.placeholder="Enter a caption",caption.innerHTML=this.data.caption||"",template.innerHTML=html,template.content.firstChild.setAttribute("src",this.data.embed),template.content.firstChild.classList.add(this.CSS.content);const n=this.embedIsReady(t);return t.appendChild(template.content.firstChild),t.appendChild(caption),n.then(()=>{t.classList.remove(this.CSS.containerLoading)}),this.element=t,t}createPreloader(){const t=document.createElement("preloader"),e=document.createElement("div");return e.textContent=this.data.source,t.classList.add(this.CSS.preloader),e.classList.add(this.CSS.url),t.appendChild(e),t}save(){return this.data}onPaste(t){const{key:e,data:n}=t.detail,{regex:r,embedUrl:o,width:l,height:c,id:d=(t=>t.shift())}=f.services[e],h=r.exec(n).slice(1),embed=o.replace(/<\%\= remote\_id \%\>/g,d(h));this.data={service:e,source:n,embed:embed,width:l,height:c}}static prepare({config:t={}}){const{services:e={}}=t;let n=Object.entries(_);const r=Object.entries(e).filter(([t,e])=>"boolean"==typeof e&&!0===e).map(([t])=>t),o=Object.entries(e).filter(([t,e])=>"object"==typeof e).filter(([t,e])=>f.checkServiceConfig(e)).map(([t,e])=>{const{regex:n,embedUrl:r,html:html,height:o,width:l,id:c}=e;return[t,{regex:n,embedUrl:r,html:html,height:o,width:l,id:c}]});r.length&&(n=n.filter(([t])=>r.includes(t))),n=n.concat(o),f.services=n.reduce((t,[e,n])=>e in t?(t[e]=Object.assign({},t[e],n),t):(t[e]=n,t),{}),f.patterns=n.reduce((t,[e,n])=>(t[e]=n.regex,t),{})}static checkServiceConfig(t){const{regex:e,embedUrl:n,html:html,height:r,width:o,id:l}=t;let c=e&&e instanceof RegExp&&n&&"string"==typeof n&&html&&"string"==typeof html;return c=(c=(c=c&&(void 0===l||l instanceof Function))&&(void 0===r||Number.isFinite(r)))&&(void 0===o||Number.isFinite(o))}static get pasteConfig(){return{patterns:f.patterns}}embedIsReady(t){let e=null;return new Promise((n,r)=>{(e=new MutationObserver(Object(v.debounce)(450,n))).observe(t,{childList:!0,subtree:!0})}).then(()=>{e.disconnect()})}}n(229);class w{static get contentless(){return!0}constructor({data:data,config:t,api:e}){this.api=e,this._CSS={block:this.api.styles.block,wrapper:"ce-delimiter"},this._data={},this._element=this.drawView(),this.data=data}drawView(){const div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div}render(){return this._element}save(t){return{}}static get toolbox(){return{icon:'<svg width="19" height="4" viewBox="0 0 19 4" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 0H7a1.25 1.25 0 1 1 0 2.5H1.25a1.25 1.25 0 1 1 0-2.5zM11 0h5.75a1.25 1.25 0 0 1 0 2.5H11A1.25 1.25 0 0 1 11 0z"/></svg>',title:"分割线"}}}n(230);class C{static get enableLineBreaks(){return!0}static get toolbox(){return{icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>',title:"列表"}}constructor({data:data,config:t,api:e}){this._elements={wrapper:null},this.settings=[{name:"unordered",title:"Unordered",icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>',default:!1},{name:"ordered",title:"Ordered",icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.819 4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0-4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0 9.357h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 0 1 0-2.137zM1.468 4.155V1.33c-.554.404-.926.606-1.118.606a.338.338 0 0 1-.244-.104A.327.327 0 0 1 0 1.59c0-.107.035-.184.105-.234.07-.05.192-.114.369-.192.264-.118.475-.243.633-.373.158-.13.298-.276.42-.438a3.94 3.94 0 0 1 .238-.298C1.802.019 1.872 0 1.975 0c.115 0 .208.042.277.127.07.085.105.202.105.351v3.556c0 .416-.15.624-.448.624a.421.421 0 0 1-.32-.127c-.08-.085-.121-.21-.121-.376zm-.283 6.664h1.572c.156 0 .275.03.358.091a.294.294 0 0 1 .123.25.323.323 0 0 1-.098.238c-.065.065-.164.097-.296.097H.629a.494.494 0 0 1-.353-.119.372.372 0 0 1-.126-.28c0-.068.027-.16.081-.273a.977.977 0 0 1 .178-.268c.267-.264.507-.49.722-.678.215-.188.368-.312.46-.371.165-.11.302-.222.412-.334.109-.112.192-.226.25-.344a.786.786 0 0 0 .085-.345.6.6 0 0 0-.341-.553.75.75 0 0 0-.345-.08c-.263 0-.47.11-.62.329-.02.029-.054.107-.101.235a.966.966 0 0 1-.16.295c-.059.069-.145.103-.26.103a.348.348 0 0 1-.25-.094.34.34 0 0 1-.099-.258c0-.132.031-.27.093-.413.063-.143.155-.273.279-.39.123-.116.28-.21.47-.282.189-.072.411-.107.666-.107.307 0 .569.045.786.137a1.182 1.182 0 0 1 .618.623 1.18 1.18 0 0 1-.096 1.083 2.03 2.03 0 0 1-.378.457c-.128.11-.344.282-.646.517-.302.235-.509.417-.621.547a1.637 1.637 0 0 0-.148.187z"/></svg>',default:!0}],this._data={style:this.settings.find(t=>!0===t.default).name,items:[]},this.api=e,this.data=data}render(){const style="ordered"===this._data.style?this.CSS.wrapperOrdered:this.CSS.wrapperUnordered;return this._elements.wrapper=this._make("ul",[this.CSS.baseBlock,this.CSS.wrapper,style],{contentEditable:!0}),this._data.items.length?this._data.items.forEach(t=>{this._elements.wrapper.appendChild(this._make("li",this.CSS.item,{innerHTML:t}))}):this._elements.wrapper.appendChild(this._make("li",this.CSS.item)),this._elements.wrapper.addEventListener("keydown",t=>{const[e,n]=[13,8];switch(t.keyCode){case e:this.getOutofList(t);break;case n:this.backspace(t)}},!1),this._elements.wrapper}save(){return this.data}static get conversionConfig(){return{export:data=>data.items.join(". "),import:t=>({items:[t],style:"unordered"})}}static get sanitize(){return{style:{},items:{br:!0}}}renderSettings(){const t=this._make("div",[this.CSS.settingsWrapper],{});return this.settings.forEach(e=>{const n=this._make("div",this.CSS.settingsButton,{innerHTML:e.icon});n.addEventListener("click",()=>{this.toggleTune(e.name);const t=n.parentNode.querySelectorAll("."+this.CSS.settingsButton);Array.from(t).forEach(button=>button.classList.remove(this.CSS.settingsButtonActive)),n.classList.toggle(this.CSS.settingsButtonActive)}),this._data.style===e.name&&n.classList.add(this.CSS.settingsButtonActive),t.appendChild(n)}),t}onPaste(t){const e=t.detail.data;this.data=this.pasteHandler(e)}static get pasteConfig(){return{tags:["OL","UL","LI"]}}toggleTune(style){this._elements.wrapper.classList.toggle(this.CSS.wrapperOrdered,"ordered"===style),this._elements.wrapper.classList.toggle(this.CSS.wrapperUnordered,"unordered"===style),this._data.style=style}get CSS(){return{baseBlock:this.api.styles.block,wrapper:"cdx-list",wrapperOrdered:"cdx-list--ordered",wrapperUnordered:"cdx-list--unordered",item:"cdx-list__item",settingsWrapper:"cdx-list-settings",settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive}}set data(t){t||(t={}),this._data.style=t.style||this.settings.find(t=>!0===t.default).name,this._data.items=t.items||[];const e=this._elements.wrapper;e&&e.parentNode.replaceChild(this.render(),e)}get data(){this._data.items=[];const t=this._elements.wrapper.querySelectorAll(`.${this.CSS.item}`);for(let i=0;i<t.length;i++){t[i].innerHTML.replace("<br>"," ").trim()&&this._data.items.push(t[i].innerHTML)}return this._data}_make(t,e=null,n={}){const r=document.createElement(t);Array.isArray(e)?r.classList.add(...e):e&&r.classList.add(e);for(const t in n)r[t]=n[t];return r}get currentItem(){let t=window.getSelection().anchorNode;return t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t.closest(`.${this.CSS.item}`)}getOutofList(t){const e=this._elements.wrapper.querySelectorAll("."+this.CSS.item);if(e.length<2)return;const n=e[e.length-1],r=this.currentItem;r!==n||n.textContent.trim().length||(r.parentElement.removeChild(r),this.api.blocks.insertNewBlock(),t.preventDefault(),t.stopPropagation())}backspace(t){const e=this._elements.wrapper.querySelectorAll("."+this.CSS.item),n=e[0];n&&e.length<2&&!n.innerHTML.replace("<br>"," ").trim()&&t.preventDefault()}selectItem(t){t.preventDefault();const e=window.getSelection(),n=e.anchorNode.parentNode.closest("."+this.CSS.item),r=new Range;r.selectNodeContents(n),e.removeAllRanges(),e.addRange(r)}pasteHandler(element){const{tagName:t}=element;let e;switch(t){case"OL":e="ordered";break;case"UL":case"LI":e="unordered"}const data={type:e,items:[]};if("LI"===t)data.items=[element.innerHTML];else{const t=Array.from(element.querySelectorAll("LI"));data.items=t.map(li=>li.innerHTML).filter(t=>!!t.trim())}return data}}n(231),n(232);class x{static get enableLineBreaks(){return!0}static get toolbox(){return{icon:'<svg width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 15a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15zm0-2.394a5.106 5.106 0 1 0 0-10.212 5.106 5.106 0 0 0 0 10.212zm-.675-4.665l2.708-2.708 1.392 1.392-2.708 2.708-1.392 1.391-2.971-2.971L5.245 6.36l1.58 1.58z"/></svg>',title:"进度表"}}constructor({data:data,config:t,api:e}){this._elements={wrapper:null,items:[]},this._data={items:[]},this.api=e,this.data=data}render(){if(this._elements.wrapper=this._make("div",[this.CSS.baseBlock,this.CSS.wrapper]),this._data.items.length)this._data.items.forEach(t=>{const e=this.createChecklistItem(t);this._elements.items.push(e),this._elements.wrapper.appendChild(e)});else{const t=this.createChecklistItem();this._elements.items.push(t),this._elements.wrapper.appendChild(t)}return this._elements.wrapper.addEventListener("keydown",t=>{const[e,n]=[13,8];switch(t.keyCode){case e:this.appendNewElement(t);break;case n:this.backspace(t)}},!1),this._elements.wrapper.addEventListener("click",t=>{this.toggleCheckbox(t)}),this._elements.wrapper}validate(t){return!!t.items.length}toggleCheckbox(t){const e=t.target.closest(`.${this.CSS.item}`);e.querySelector(`.${this.CSS.checkbox}`).contains(t.target)&&e.classList.toggle(this.CSS.itemChecked)}createChecklistItem(t={}){const e=this._make("div",this.CSS.item),n=this._make("span",this.CSS.checkbox),r=this._make("div",this.CSS.textField,{innerHTML:t.text?t.text:"",contentEditable:!0});return t.checked&&e.classList.add(this.CSS.itemChecked),e.appendChild(n),e.appendChild(r),e}appendNewElement(t){t.preventDefault();const e=window.getSelection().anchorNode,n=this._elements.items[this._elements.items.length-1].querySelector(`.${this.CSS.textField}`),r=n.innerHTML.replace("<br>"," ").trim();if(e===n&&!r)return this.api.blocks.insertNewBlock(),void t.stopPropagation();const o=this.createChecklistItem(),l=e.parentNode.closest(`.${this.CSS.item}`);this._elements.wrapper.insertBefore(o,l.nextSibling);const c=this._elements.items.indexOf(l)+1;this._elements.items.splice(c,0,o),this.moveCaretToEnd(o.querySelector(`.${this.CSS.textField}`))}backspace(t){const e=t.target.closest(`.${this.CSS.item}`),n=this._elements.items.indexOf(e),r=e.querySelector(`.${this.CSS.textField}`).innerHTML.replace("<br>"," ").trim();this._elements.items[0].querySelector(`.${this.CSS.textField}`).innerHTML.replace("<br>"," ").trim()&&n&&!r&&(t.preventDefault(),e.remove(),this._elements.items.splice(n,1),"undefined"!==this._elements.items[n-1]&&this.moveCaretToEnd(this._elements.items[n-1].querySelector(`.${this.CSS.textField}`)))}save(){return this.data}get CSS(){return{baseBlock:this.api.styles.block,wrapper:"cdx-checklist",item:"cdx-checklist__item",itemChecked:"cdx-checklist__item--checked",checkbox:"cdx-checklist__item-checkbox",textField:"cdx-checklist__item-text"}}set data(t){this._data.items=t.items||[];const e=this._elements.wrapper;e&&e.parentNode.replaceChild(this.render(),e)}get data(){this._data.items=[];for(let i=0;i<this._elements.items.length;i++){const t=this._elements.items[i].querySelector(`.${this.CSS.textField}`).innerHTML.replace("<br>"," ").trim();t&&this._data.items.push({text:t,checked:this._elements.items[i].classList.contains(this.CSS.itemChecked)})}return this._data}_make(t,e=null,n={}){const r=document.createElement(t);Array.isArray(e)?r.classList.add(...e):e&&r.classList.add(e);for(const t in n)r[t]=n[t];return r}moveCaretToEnd(element){const t=document.createRange(),e=window.getSelection();t.selectNodeContents(element),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}class S{static get CSS(){return"cdx-marker"}constructor({api:t}){this.api=t,this.button=null,this.tag="MARK",this.iconClasses={base:this.api.styles.inlineToolButton,active:this.api.styles.inlineToolButtonActive}}static get isInline(){return!0}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.classList.add(this.iconClasses.base),this.button.innerHTML=this.toolboxIcon,this.button}surround(t){if(!t)return;const e=this.api.selection.findParentTag(this.tag);e?this.unwrap(e):this.wrap(t)}wrap(t){const marker=document.createElement(this.tag);marker.appendChild(t.extractContents()),t.insertNode(marker),this.api.selection.expandToTag(marker)}unwrap(t){this.api.selection.expandToTag(t);const e=window.getSelection(),n=e.getRangeAt(0),r=n.extractContents();t.parentNode.removeChild(t),n.insertNode(r),e.removeAllRanges(),e.addRange(n)}checkState(){const t=this.api.selection.findParentTag(this.tag);this.button.classList.toggle(this.iconClasses.active,!!t)}get toolboxIcon(){return'<svg width="34" height="34" xmlns="http://www.w3.org/2000/svg"><path d="M17.78 19.543l3.085 1.78-.825 1.499-1.04-.033-1.03 1.784h-2.075l1.575-2.73-.537-.82.848-1.48zm.578-1.007l3.83-6.687a1.688 1.688 0 0 1 2.303-.626l.003.002a1.725 1.725 0 0 1 .65 2.327l-3.719 6.755-3.067-1.771zm-8.17 3.665h3.662a1.187 1.187 0 0 1 0 2.374h-3.663a1.187 1.187 0 1 1 0-2.374z"/></svg>'}static get sanitize(){return{mark:{class:S.CSS}}}}n(233);class k{static get DEFAULT_PLACEHOLDER(){return""}constructor({data:data,config:t,api:e}){this.api=e,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.onKeyUp=this.onKeyUp.bind(this),this._placeholder=t.placeholder?t.placeholder:k.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),this.data=data}onKeyUp(t){if("Backspace"!==t.code&&"Delete"!==t.code)return;const{textContent:e}=this._element;""===e&&(this._element.innerHTML="")}drawView(){const div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div.contentEditable=!0,div.dataset.placeholder=this._placeholder,div.addEventListener("keyup",this.onKeyUp),div}render(){return this._element}merge(data){this.data={text:this.data.text+data.text}}validate(t){return!(""===t.text.trim()||/vanced issues found/.test(t.text))}save(t){return{text:t.innerHTML}}onPaste(t){this.data={text:t.detail.data.innerHTML}}static get conversionConfig(){return{export:"text",import:"text"}}static get sanitize(){return{text:{br:!0}}}get data(){return this._data.text=this._element.innerHTML,this._data}set data(data){this._data=data||{},this._element.innerHTML=this._data.text||""}static get pasteConfig(){return{tags:["P"]}}}n(234);class y{constructor({data:data,api:t}){this.data=data,this.api=t,this.i=0}static get toolbox(){return{title:"投票",icon:'<svg width="16px" height="16px" viewBox="0 0 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <g>\n        <path d="M41.4155893,104.612406 L4.34624771,94.6931616 C13.1781391,61.9709983 34.6149911,34.0810288 63.963975,17.12876 L83.1377724,50.312212 C62.5992931,62.1854523 47.5983285,81.7087666 41.4155893,104.612406 Z M104.765816,41.3644398 L94.7954412,4.29509827 C105.588572,1.42972965 116.709637,-0.014117987 127.876633,6.268195e-05 L127.876633,38.3477624 C120.074942,38.3489813 112.306418,39.3630143 104.765816,41.3644398 Z M151.243101,41.3644398 L161.162345,4.34622839 C193.864446,13.158612 221.749859,34.5551981 238.726747,63.8616954 L205.492165,83.0354928 C193.620691,62.5270309 174.118979,47.5469224 151.243101,41.3644398 Z M6.98577306e-05,127.825483 L38.3477817,127.825483 C38.3379176,135.627892 39.3521378,143.39785 41.3644592,150.936301 L4.29511759,160.855545 C1.4289919,150.079973 -0.0149068619,138.975704 6.98577306e-05,127.825483 Z M17.1287793,191.738141 L50.5167518,172.564344 C54.4399333,179.319101 59.2173462,185.540049 64.7309269,191.07345 L37.5808298,218.172417 C29.6359374,210.294072 22.7598244,201.406696 17.1287793,191.738141 Z M63.963975,238.522207 L83.1377724,205.338755 C96.7208334,213.190976 112.136121,217.318181 127.825503,217.303205 L127.825503,255.650857 C105.400386,255.672229 83.3684176,249.762934 63.963975,238.522207 Z M205.441035,172.666604 L238.624487,191.891532 C221.625506,221.189321 193.721285,242.567851 161.008955,251.355869 L151.08971,214.286527 C173.99481,208.14046 193.535532,193.17701 205.441035,172.666604 Z M251.458148,162.184928 L214.593327,152.061163 C218.680428,136.855633 218.680428,120.840539 214.593327,105.635009 L251.764929,95.7157641 C257.513853,117.513081 257.408029,140.441606 251.458148,162.184928 Z" fill-rule="nonzero"></path>\n    </g>\n</svg>'}}render(){if(document.querySelectorAll(".vote-wrap").length>0)return void this.api.notifier.show({message:"一篇文章只能包含一个投票",style:"error"});const t=document.createElement("div");t.classList.add("vote-wrap");const e=document.createElement("p");e.textContent="投票（文章发表后无法再修改）";const n=document.createElement("ul"),r=document.createElement("button");r.classList.add("vote-append","el-icon-plus");const o=text=>{const e=document.createElement("li"),label=document.createElement("span");label.textContent=`${++this.i}. `;const input=document.createElement("input");if(input.type="text",input.placeholder="请输入选项（20字以内）",text&&(input.value=("string"==typeof text?text:text.text)||""),input.maxLength=20,input.classList.add("vote-answer"),e.classList.add("vote-wrap-item"),e.appendChild(label),e.appendChild(input),this.i>2){const o=document.createElement("button");o.classList.add("el-icon-circle-close"),o.addEventListener("click",()=>{n.removeChild(e),this.i--,this.i<100&&(r.style.display="block");const o=t.querySelector(".vote-wrap-select-count");o&&(o.max=this.i,o.value-this.i>0&&(o.value=this.i))}),e.appendChild(o)}n.appendChild(e),input.focus()};r.addEventListener("click",()=>{o(),this.i>=100&&(r.style.display="none");const e=t.querySelector(".vote-wrap-select-count");e&&(e.max=this.i)});return t.appendChild(e),t.appendChild(n),t.appendChild(r),this.data&&this.data.items?this.data.items.forEach(o):(o(),o()),(()=>{const footer=document.createElement("footer"),e=document.createElement("span");e.textContent="可选个数";const n=document.createElement("input");n.type="number",n.classList.add("vote-wrap-select-count"),n.min=1,this.data&&this.data.max_select?n.value=this.data.max_select:n.value=1,n.max=this.i,footer.appendChild(e),footer.appendChild(n);const r=document.createElement("span");r.textContent="截止时间（可选）";const o=document.createElement("input");o.type="date",o.min=new Date(Date.now()+864e5).toISOString().split("T")[0],o.classList.add("vote-expire-input"),this.data&&this.data.expired_at&&(o.value=new Date(1e3*this.data.expired_at).toISOString().split("T")[0]),footer.appendChild(r),footer.appendChild(o),t.appendChild(footer)})(),t}save(t){const e=t.querySelectorAll(".vote-answer"),n=[];[].forEach.call(e,function(t){n.push(t.value)});const r=t.querySelector(".vote-expire-input");return{items:n.map(t=>t.trim()).filter(t=>t),right_ids:[],max_select:+t.querySelector(".vote-wrap-select-count").value,expired_at:r&&r.value?parseInt(new Date(r.value).getTime()/1e3):0}}validate(t){return t.items.length>1}}var L={name:"JsonEditor",mixins:[c.a],props:{value:{required:!0,type:Array},slug:{type:String,default:""},time:{type:[String,Number],default:""},autofocus:{type:Boolean,default:!1}},data:()=>({editor:null}),mounted(){this.initEditor()},methods:{initEditor(){Promise.all([Promise.resolve().then(n.t.bind(null,76,7)),n.e(39).then(n.bind(null,331)),n.e(40).then(n.bind(null,292))]).then(t=>{const e=this;let data={};if(e.slug){const t=e.$cache.get(`editor_local_draft-${e.slug}`);data=t&&t.time>e.$utils.adjustTime(e.time)?t:{blocks:e.value,time:Date.now(),version:e.$cache.get("editor_version","2.15.0")}}else(data=e.$cache.get("editor_local_draft-"))&&e.$emit("input",data.blocks);const[n,r,o]=t.map(t=>t.default),l=new n({data:e.decodeData(data||{}),holder:"codex-editor",placeholder:"请输入内容",autofocus:e.autofocus,tools:{video:{class:f,inlineToolbar:!0},marker:{class:S,shortcut:"CMD+SHIFT+M"},header:{class:h,inlineToolbar:!0},image:{class:r,types:"image/jpeg, image/png, image/jpg",config:{uploader:{uploadByFile:t=>new Promise((n,r)=>{const o=new FormData;o.append("file",t),o.append("token",e.uploadHeaders.token),Object(d.b)(e,o).then(data=>{data.url=`https://m1.calibur.tv/${data.url}`,n({success:1,file:data})}).catch(r)})}}},link:{class:o,config:{endpoint:"https://api.calibur.tv/v1/pin/editor/fetch_site"}},delimiter:{class:w},list:{class:C,inlineToolbar:!0},checklist:{class:x,inlineToolbar:!0},baidu:{class:m},paragraph:{class:k},vote:{class:y}},onChange:()=>{e.handleSave()}});l.isReady.then(()=>{this.editor=l,this.bindSaveEvent(),this.handleSave()}).catch(t=>{this.$toast.error(`编辑器初始化失败：${t}`)})})},bindSaveEvent(){document.addEventListener("keydown",t=>{83===t.keyCode&&(t.ctrlKey||t.metaKey)&&(t.stopPropagation(),t.preventDefault(),this.handleSave())},!1)},handleSave(){this.editor&&this.editor.save().then(t=>{const e=this.encodeData(t),n=`editor_local_draft-${this.slug||""}`;this.$cache.set(n,e),this.$cache.set("editor_version",e.version),this.value&&this.$emit("input",e.blocks),this.$emit("save")}).catch(()=>{this.$toast.error("保存失败")})},decodeData:({version:t,blocks:e,time:time})=>e?(e.forEach((t,n)=>{"music"===t.type&&(e[n].type="video")}),{version:t,blocks:e,time:time}):null,encodeData:({version:t,blocks:e,time:time})=>(e.forEach((t,n)=>{"video"===t.type&&t.data.service.startsWith("netease")&&(e[n].type="music",e[n].data.embed=e[n].data.embed.replace(/&amp;/g,"&"))}),{version:t,blocks:e,time:time})}},E=n(2);var $=Object(E.a)(L,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"editor-wrap"},[this._ssrNode('<div id="codex-editor" class="mousetrap"></div>')])},[],!1,function(t){var e=n(235);e.__inject__&&e.__inject__(t)},null,"6ceb90c0").exports,T=n(220),M=n(54),H=n.n(M),A=n(53),I=n.n(A),U={name:"TopicPicker",components:{ElSelect:I.a,ElOption:H.a},props:{value:{type:String,required:!0},placeholder:{type:String,default:"选择作品话题，如 cosplay"}},data(){return{selected:this.value}},computed:{options(){return this.$store.state.global.myTags.filter(t=>"topic"===t.slug)[0].children},myTagsFetched(){return this.$store.state.global.myTagsFetched}},watch:{value(t){this.selected=t},selected(t){this.$emit("input",t)}},mounted(){this.$store.state.isAuth?this.$store.dispatch("global/getMyTags"):this.$channel.$when("user-signed",()=>{this.$store.dispatch("global/getMyTags")})}};var B=Object(E.a)(U,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-picker"},[t._ssrNode('<p class="tip">\n    提示：只展示已关注的话题（必选项，填写后不可修改）\n  </p> '),t.myTagsFetched?n("ElSelect",{attrs:{filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.options,function(t){return n("ElOption",{key:t.slug,attrs:{label:t.name,value:t.slug}})}),1):t._e()],2)},[],!1,function(t){var e=n(236);e.__inject__&&e.__inject__(t)},null,"265327c2").exports,z=n(87),N={name:"NotebookPicker",components:{ElSelect:I.a,ElOption:H.a,CreateTagBtn:z.a},props:{value:{type:String,required:!0}},data(){return{selected:this.value,newTags:[]}},computed:{options(){return this.newTags.concat(this.$store.state.global.myTags.filter(t=>"notebook"===t.slug)[0].children)},myTagsFetched(){return this.$store.state.global.myTagsFetched}},watch:{selected(t){this.$emit("input",t)},value(t){this.selected=t},"options.length"(){this.selected||(this.selected=this.options[0].slug)}},mounted(){this.$store.state.isAuth?this.$store.dispatch("global/getMyTags"):this.$channel.$when("user-signed",()=>{this.$store.dispatch("global/getMyTags")})},methods:{handleCreate(data){this.newTags.unshift(data),this.selected=data.slug}}};var O=Object(E.a)(N,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notebook-picker"},[t._ssrNode('<div class="new-btn">',"</div>",[n("CreateTagBtn",{attrs:{title:"新建专栏",parent:"uh4f"},on:{create:t.handleCreate}})],1),t._ssrNode(" "),t._ssrNode('<div class="selection">',"</div>",[t.myTagsFetched?n("ElSelect",{attrs:{filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.options,function(t){return n("ElOption",{key:t.slug,attrs:{label:t.name,value:t.slug}})}),1):t._e()],1)],2)},[],!1,function(t){var e=n(237);e.__inject__&&e.__inject__(t)},null,"34570c34").exports,P={name:"Wanderer",layout:"web",components:{Editor:$,AreaPicker:T.a,TopicPicker:B,NotebookPicker:O,ElUpload:o.a},mixins:[l.a,c.a],head:{title:"创作中心"},data:()=>({slug:"",title:{banner:null,text:""},content:[],notebook:"",area:"",topic:"ugf6",last_edit_at:"",published_at:"",loading:!1}),asyncData({app:t,error:e,query:n}){const r=n.slug;if(r)return t.$axios.$get("v1/pin/update/content",{params:{slug:r}}).then(data=>(data.area=data.area?data.area.slug:"",data.topic=data.topic?data.topic.slug:"",data.notebook=data.notebook?data.notebook.slug:"",{...data})).catch(e)},mounted(){this.$cache.has(`editor_local_draft_title-${this.slug}`)&&(this.title=this.$cache.get(`editor_local_draft_title-${this.slug}`))},methods:{customImageUploadSuccess(t,e){this.handleImageUploadSuccess(t,e);const n=t.data;if(n.width<960||n.height<540)return this.handleImageUploadRemove(e),void this.$toast.info("图片尺寸不符合要求");this.title.banner=n,this.saveTitle()},onEditorSave(){this.saveTitle()},saveTitle(){this.$cache.set(`editor_local_draft_title-${this.slug}`,this.title)},deleteBanner(){this.title.banner=null,this.saveTitle()},preValidate(){return!!this.loading||(this.title.text?this.content.length?this.topic?this.notebook?(this.loading=!0,!1):(this.$toast.info("请选择专栏"),!0):(this.$toast.info("请选择话题"),!0):(this.$toast.info("内容不能为空"),!0):(this.$toast.info("标题不能为空"),!0))},actionCreate(t){this.preValidate()||this.$axios.$post("v1/pin/create/story",{area:this.area,topic:this.topic,notebook:this.notebook,content:[{type:"title",data:this.title}].concat(this.content),publish:t}).then(t=>{this.removeCache(),window.location=this.$alias.pin(t)}).catch(t=>{this.$toast.error(t.message),this.loading=!1})},actionUpdate(t){if(this.preValidate())return;const{slug:e}=this;this.$axios.$post("v1/pin/update/story",{slug:e,area:this.area,topic:this.topic,notebook:this.notebook,content:[{type:"title",data:this.title}].concat(this.content),publish:t}).then(t=>{this.removeCache(),window.location=this.$alias.pin(t)}).catch(t=>{this.$toast.error(t.message),this.loading=!1})},actionRedo(){(this.content.length||this.title.text.length||this.title.banner)&&(this.removeCache(),this.$toast.success(this.slug?"撤销成功":"删除成功").then(()=>{window.location.reload()}))},removeCache(){this.$cache.remove(`editor_local_draft_title-${this.slug}`),this.$cache.remove(`editor_local_draft-${this.slug}`)}}};var V=Object(E.a)(P,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"wander"}},[t._ssrNode('<div class="wrap">',"</div>",[t._ssrNode('<div class="banner">',"</div>",[n("ElUpload",{staticClass:"uploader",attrs:{drag:"",action:t.imageUploadAction,accept:t.imageUploadAccept,data:t.uploadHeaders,"before-upload":t.handleImageUploadBefore,"on-success":t.customImageUploadSuccess,"on-error":t.handleImageUploadError}},[n("div",{staticClass:"el-upload-tip",attrs:{slot:"tip"},slot:"tip"},[n("i",{staticClass:"el-icon-picture"}),t._v(" "),n("div",[t._v("请添加封面图（选填）")]),t._v(" "),n("p",[t._v("支持8MB内的JPG／JPEG／PNG格式的高清图片"),n("br"),t._v("（建议大于960*540像素）")])])]),t._ssrNode(" "+(t.title&&t.title.banner?'<div class="image"'+t._ssrStyle(null,{backgroundImage:"url("+t.$resize(t.title.banner.url,{width:660})},null)+'></div> <div class="tool"><i class="el-icon-delete"></i></div>':"\x3c!----\x3e"))],2),t._ssrNode(" "),t._ssrNode('<div class="title">',"</div>",[n("ElInput",{attrs:{"show-word-limit":!0,autosize:{minRows:1,maxRows:2},type:"textarea",resize:"none",placeholder:"请输入标题（建议30字以内）",maxlength:"40"},model:{value:t.title.text,callback:function(e){t.$set(t.title,"text",e)},expression:"title.text"}})],1),t._ssrNode(" "),n("Editor",{attrs:{slug:t.slug,time:t.last_edit_at},on:{save:t.onEditorSave},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._ssrNode(" "),n("ElForm",{staticClass:"footer",attrs:{"label-position":"top","label-width":"80px"}},[n("ElFormItem",{attrs:{label:"选择分区"}},[n("AreaPicker",{model:{value:t.area,callback:function(e){t.area=e},expression:"area"}})],1),t._v(" "),n("ElFormItem",{attrs:{label:"选择话题"}},[n("TopicPicker",{model:{value:t.topic,callback:function(e){t.topic=e},expression:"topic"}})],1),t._v(" "),n("ElFormItem",{attrs:{label:"选择专栏"}},[n("NotebookPicker",{model:{value:t.notebook,callback:function(e){t.notebook=e},expression:"notebook"}})],1),t._v(" "),n("ElFormItem",{staticClass:"button-wrap"},[t.slug?[n("ElButton",{attrs:{loading:t.loading,type:"success",round:""},on:{click:function(e){return t.actionUpdate(!0)}}},[t._v("\n            "+t._s(t.published_at?"发布更新":"更新并发布")+"\n          ")]),t._v(" "),t.published_at?t._e():n("ElButton",{attrs:{loading:t.loading,round:"",plain:"",type:"warning"},on:{click:function(e){return t.actionUpdate(!1)}}},[t._v("\n            存草稿\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,type:"primary",round:"",plain:""},on:{click:t.actionRedo}},[t._v("\n            撤销修改\n          ")])]:[n("ElButton",{attrs:{loading:t.loading,type:"success",round:""},on:{click:function(e){return t.actionCreate(!0)}}},[t._v("\n            发表文章\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,round:"",plain:"",type:"warning"},on:{click:function(e){return t.actionCreate(!1)}}},[t._v("\n            存草稿\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,type:"primary",round:"",plain:""},on:{click:t.actionRedo}},[t._v("\n            删除文章\n          ")])]],2)],1)],2)])},[],!1,function(t){var e=n(238);e.__inject__&&e.__inject__(t)},null,"4533f6be");e.default=V.exports},86:function(t,e,n){"use strict";e.a={beforeMount(){this.$channel.$when("user-not-sign",()=>{this.$toast.error("继续操作前请先登录").then(()=>{window.location.href=this.$alias.sign()})})}}},87:function(t,e,n){"use strict";var r=n(22),o={name:"CreateTagBtn",props:{title:{type:String,default:"新建分区"},parent:{type:String,required:!0}},methods:{actionCreate(){this.$prompt("请输入名称",this.title,{confirmButtonText:"提交",cancelButtonText:"取消"}).then(({value:t})=>{const e=t.trim();if(e.length>32)return this.$toast.error("名字不能超过32个字");Object(r.b)(this,{name:e,parent_slug:this.parent}).then(data=>{this.$emit("create",data)}).catch(t=>{this.$toast.error(t.message)})}).catch(()=>{})}}},l=n(2),component=Object(l.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{attrs:{type:"button"},on:{click:this.actionCreate}},[this._t("default",[e("i",{staticClass:"el-icon-folder-add"}),this._v(" "),e("span",{domProps:{textContent:this._s(this.title)}})])],2)},[],!1,null,null,"ed0a5c0a");e.a=component.exports},93:function(t,e,n){"use strict";var r=n(94);e.a={data:()=>({uploadHeaders:{key:"",token:""},uploadConfig:{max:5},uploadImageLimit:20,imageUploadAccept:["image/jpeg","image/png","image/jpg"].join(", "),imageUploadAction:"https://upload.qiniup.com",imagePrefix:"https://m1.calibur.tv/",getUpTokenTimer:0,uploadPending:0,uploadImageTotal:0,uploadImageList:[]}),computed:{currentUser(){return this.$store.state.user},isAuth(){return this.$store.state.isAuth}},mounted(){this.isAuth?this.initUpToken():this.$channel.$when("user-signed",()=>{this.initUpToken()})},beforeDestroy(){this.getUpTokenTimer&&clearInterval(this.getUpTokenTimer)},methods:{initUpToken(){this.getUpToken(),this.getUpTokenTimer=setInterval(()=>{this.getUpToken()},18e5)},async getUpToken(){let t=this.$cookie.get("UPLOAD-TOKEN");t?this.uploadHeaders.token=this.$cookie.get("UPLOAD-TOKEN"):(t=await Object(r.a)(this),this.uploadHeaders.token=t,this.$cookie.set("UPLOAD-TOKEN",t,{expires:new Date((new Date).getTime()+3e6)}))},handleImageUploadError(t,e){this.uploadImageList.forEach((n,r)=>{n.uid===e.uid&&(this.uploadPending--,this.uploadImageList.splice(r,1),console.log(t))}),this.$toast.error(`图片：${e.name} 上传失败`)},handleImageUploadRemove(t){this.uploadImageList.forEach((e,n)=>{e.uid===t.uid&&(this.uploadImageList.splice(n,1),this.uploadImageTotal--)})},handleImageUploadSuccess(t,e){this.uploadImageList.forEach((n,r)=>{n.uid===e.uid&&(this.uploadImageList[r]=Object.assign(n,{data:t.data,status:"success",url:this.$resize(`${this.imagePrefix}${t.data.url}`,{width:100})}))}),this.uploadImageTotal++,this.uploadPending--},handleImageUploadExceed(){this.$toast.info(`最多还能上传${this.uploadImageLimit-this.uploadImageTotal}张图片`)},handleImageUploadBefore(t){if(!this.isAuth)return this.$channel.$emit("sign-in"),!1;if(!this.imageUploadAccept.split(", ").includes(t.type))return this.$toast.error(`仅支持上传${this.imageUploadAccept.replace(/image\//g,"").replace(/, /g,"、")}格式的图片`),!1;if(this.uploadConfig.max&&this.uploadConfig.max<t.size/1024/1024)return this.$toast.error(`图片大小不能超过 ${this.uploadConfig.max}MB!`),!1;return this.uploadHeaders.key=(({slug:t,file:e})=>`${t}/${(new Date).getTime()}-${Math.random().toString(36).substring(3,6)}.${e.type.split("/").pop()}`)({slug:this.currentUser.slug,file:t}),this.uploadImageList.push({name:t.name,percentage:0,raw:t,size:t.size,status:"uploading",errMsg:"",uid:t.uid}),this.uploadPending++,!0},resetUploaderStatus(){this.uploadImageList=[],this.uploadImageTotal=0,this.uploadPending=0}}}},94:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o});const r=t=>t.$axios.$get("v1/image/uptoken"),o=(t,e)=>t.$axios.$post("https://up.qbox.me",e,{"Content-Type":"multipart/form-data"})}};
//# sourceMappingURL=77a664aaf4d5136e2b97.js.map