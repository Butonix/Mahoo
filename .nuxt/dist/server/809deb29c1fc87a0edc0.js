exports.ids=[18],exports.modules={102:function(t,e,r){"use strict";r.r(e);var n=r(49),o=r.n(n),c=(r(89),{name:"ChatAvatar",components:{UserAvatar:r(78).a},props:{item:{type:Object,required:!0}},computed:{isMine(){return this.$store.state.user.slug===this.item.slug}}}),l=r(1);var f=Object(l.a)(c,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-avatar",class:[this.isMine?"chat-avatar-mine":"chat-avatar-other"]},[e("user-avatar",{attrs:{user:this.item,size:36}})],1)},[],!1,function(t){var e=r(90);e.__inject__&&e.__inject__(t)},null,"fe81d1a0").exports,d=r(20),m=r(7),h={name:"UserMessage",components:{ChatRoom:o.a},props:{},data:()=>({message:"",target:null}),computed:{avatarComp:()=>f,mailto(){return this.$router.query.mailto}},watch:{"$store.state.socket.lastGetAt"(){this.appendMessage(this.$store.state.socket.message)}},created(){},mounted(){this.getMailtoUser()},methods:{getMailtoUser(){this.mailto&&Object(m.c)(this,{slug:this.mailto}).then(t=>{this.target=t}).catch(t=>{this.$toast.error(t.message)})},appendMessage(t){this.$refs.room.addMessage({type:"text-msg",float:"left",id:Math.random().toString(10).substring(3,6),color:2===t.from_user.sex?{bg:"#ff6881",text:"#fff"}:{bg:"#00a1d6",text:"#fff"},data:{content:t.content,created_at:t.created_at,user:t.from_user}})},handleAddBubble(){if(!this.message.trim())return;const t=this.$store.state.user,content=this.message.trim().replace(/\r?\n/g,"<br>");this.$refs.room.addMessage({type:"text-msg",float:"right",id:Math.random().toString(10).substring(3,6),color:2===t.sex?{bg:"#ff6881",text:"#fff"}:{bg:"#00a1d6",text:"#fff"},data:{content:content,created_at:Date.now(),user:t}}),this.message="",this.$channel.send({message_type:0,to_user_slug:this.mailto,from_user_token:Object(d.a)(),content:[{type:"txt",text:content}]})},handleNewLine(){this.message&&(this.message+="\n")}}};var _=Object(l.a)(h,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container",attrs:{id:"user-message"}},[r("el-row",[r("el-col",{attrs:{span:6}},[t._v("\n \n      ")]),t._v(" "),r("el-col",{attrs:{span:12}},[r("ChatRoom",{ref:"room",attrs:{"avatar-component":t.avatarComp}}),t._v(" "),r("div",[r("el-input",{attrs:{type:"textarea",rows:5,resize:"none",maxlength:"500",placeholder:"say it..."},nativeOn:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.handleAddBubble(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.metaKey?(e.preventDefault(),t.handleNewLine(e)):null}]},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:6}},[t._v("\n \n      ")])],1)],1)},[],!1,function(t){var e=r(91);e.__inject__&&e.__inject__(t)},null,"c7ef127c");e.default=_.exports},52:function(t,e){},61:function(t,e,r){"use strict";r.r(e);var n=r(52),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},66:function(t,e){},67:function(t,e){},78:function(t,e,r){"use strict";var n={name:"UserAvatar",props:{user:{type:Object,required:!0},avatar:{type:String,default:""},size:{type:Number,default:40}}},o=r(1);var component=Object(o.a)(n,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nuxt-link",{staticClass:"user-avatar",style:{width:t.size+"px",height:t.size+"px"},attrs:{to:t.$alias.user(t.user.slug)}},[r("img",{staticClass:"avatar",attrs:{src:t.$resize(t.avatar||t.user.avatar,{width:t.size}),alt:t.user.nickname}})])},[],!1,function(t){var e=r(61);e.__inject__&&e.__inject__(t)},null,"752b3908");e.a=component.exports},89:function(t,e){},90:function(t,e,r){"use strict";r.r(e);var n=r(66),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},91:function(t,e,r){"use strict";r.r(e);var n=r(67),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a}};
//# sourceMappingURL=809deb29c1fc87a0edc0.js.map