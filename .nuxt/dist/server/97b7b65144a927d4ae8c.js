exports.ids=[1],exports.modules={115:function(t,e,n){"use strict";var c=n(27);e.a={async beforeMount(){if(this.$store.state.logging){const t=this.$watch("$store.state.logging",()=>{this.$store.state.isAuth?(this.$channel.$fire("user-signed"),t()):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))})}else{const t=Object(c.a)();this.$store.commit("SET_USER_TOKEN",t),await this.$store.dispatch("initAuth")?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))}}}},267:function(t,e,n){"use strict";e.a={beforeMount(){this.$channel.$when("user-signed",()=>{const t=()=>Date.now()-this.$cache.get("socket-connect-heartbeat",0)<=1e3;setTimeout(()=>{const e=()=>{this.$channel.socketConnect();const t=setInterval(()=>{this.$store.state.socket.isConnected?this.$cache.set("socket-connect-heartbeat",Date.now()):clearInterval(t)},1e3);window.addEventListener("beforeunload",()=>{this.$channel.socketDisconnect()})},n=()=>{const n=setInterval(()=>{t()?Date.now()-this.$cache.get("socket-on-message-time",0)<=1e3&&this.$store.commit("SOCKET_ONMESSAGE",this.$cache.get("socket-on-message-data")):"visible"===document.visibilityState&&(e(),clearInterval(n))},2e3)};t()||"visible"!==document.visibilityState?(this.$store.commit("SOCKET_AUTO_CONNECT"),n()):e()},2e3)})},beforeDestroy(){this.$store.state.socket.isConnected&&this.$channel.socketDisconnect()}}},268:function(t,e){},359:function(t,e,n){"use strict";n.r(e);var c=n(268),o=n.n(c);for(var r in c)"default"!==r&&function(t){n.d(e,t,(function(){return c[t]}))}(r);e.default=o.a},388:function(t,e,n){"use strict";n.r(e);var c=n(115),o=n(267),r={name:"AppLayout",mixins:[c.a,o.a],data:()=>({activeIndex:0}),beforeMount(){this.$channel.$when("user-not-sign",()=>{this.$router.replace(`/app/sign?redirect=${encodeURIComponent("/app/found")}`)})},methods:{handleClick(t){this.$channel.$emit("main-tab-click",t),t===this.activeIndex&&this.$channel.$emit("main-tab-refresh",t),this.activeIndex=t}}},l=n(1);var component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app-layout"}},[n("keep-alive",[n("nuxt",{staticClass:"main-view"})],1),t._ssrNode(" "),t._ssrNode('<div id="main-tab">',"</div>",[t._ssrNode('<div class="tab-core">',"</div>",[n("NLink",{staticClass:"link-0",attrs:{to:"/app/found",replace:""},nativeOn:{click:function(e){return t.handleClick(0)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("发现")])]),t._ssrNode(" "),n("NLink",{staticClass:"link-1",attrs:{to:"/app/category",replace:""},nativeOn:{click:function(e){return t.handleClick(1)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("圈子")])]),t._ssrNode(" "),n("NLink",{staticClass:"link-write",attrs:{to:"/app/write"}},[n("i",{staticClass:"iconfont ic-addition_fill"})]),t._ssrNode(" "),n("NLink",{staticClass:"link-2",attrs:{to:"/app/notice",replace:""},nativeOn:{click:function(e){return t.handleClick(2)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("消息")])]),t._ssrNode(" "),n("NLink",{staticClass:"link-3",attrs:{to:"/app/home",replace:""},nativeOn:{click:function(e){return t.handleClick(3)}}},[n("i",{staticClass:"iconfont"}),t._v(" "),n("span",[t._v("我的")])])],2)])],2)}),[],!1,(function(t){var e=n(359);e.__inject__&&e.__inject__(t)}),null,"20d0d05c");e.default=component.exports}};